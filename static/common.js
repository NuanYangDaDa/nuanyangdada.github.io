var SubmitFormSettingObject, PopupConfirmWindowParameters, LoadedScriptURLArray, AjaxResultObject, ShowLoadingOverlayedDIVID, PopupDialogWindowID, CurrentBulkEditColumnSetting, CurrentTipsID, AddationalQueryString = "", LoaderImg = "<img src='image/loader_small.gif' />", AjaxLoaderImg = "<img src='image/ajax-loader.gif' />", AlertImg = "<img src='image/alert.gif' />", SelectedImg = "<img src='image/icon_ok.png' />", NoPhotoImage = "<img src='image/NoPhoto.gif' />", JQueryUIButtonClassName = "ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only", DisplayCheckedHTML = '<p><span style="border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;padding:0cm;">√</span></p>', DisplayUnCheckedHTML = '<p><span style="border:solid windowtext 1.0pt;mso-border-alt:solid windowtext .5pt;padding:0cm;"><font style="visibility:hidden;">√</font></span></p>', DirectorySeparator = "/", CellDataSeparator = "||", CellFieldSeparator = ":", CommonSeparator = ":::", ParentDirectoriesListSeparator = "||", NullGuid = "00000000-0000-0000-0000-000000000000", NotAllowNullString = "<font class='RemindText'><b>*</b></font>", ExtraAjaxPostDataObject = {}, PageDynamicObject = {}; PageDynamicObject.ChildTableInitiateAutoComplete = {}, PageDynamicObject.UserCustomizedDataSelectorColumnMapping = {}; var FormPanelHashMap = {}, InitiateWorkFlowCompleteCallBack = null, InitiateWorkFlowJavaScript = null, OS = "Android", IconSelectorSuccessCallBack = null; function $$(e) {try {return $(e)} catch (n) {return null} } function DomReady(e) {$(document).ready(e)} function CallBack(e) {return e()} function IsInIframe() {return self != top} function CheckIsMobileV5() {return IsInIframe(), PageParameterObject.hasOwnProperty("RequestQueryDictionary") && PageParameterObject.RequestQueryDictionary.hasOwnProperty("IsMobileV5") && "true" == PageParameterObject.RequestQueryDictionary.IsMobileV5} function GetMapAppKey() {return "undefined" == typeof MapAppKeyList ? "" : MapAppKeyList[RandomNumber(MapAppKeyList.length) - 1]} function RandomNumber(e) {return Math.floor(Math.random() * e + 1)} function IsIE() {return window.navigator.userAgent.indexOf("MSIE") >= 1} function IsBrowser() {return "undefined" == typeof app} function VoidFunction() { } var SearchElement = {SearchFirstParent: function (e, n) {return $(e).closest(n)}, Parent: function (e, n) {return $(e).parent().parent(n)}, SameRoot: function (e, n, o) {return this.Parent(e, n).find(o)}, Children: function (e, n) {return e.children(n)}}, AutoCompleteObjectIDDataSoureArrayDictionary = {}; function InitiateAutoComplete(e, n, o, a) {try {if (AutoCompleteObjectIDDataSoureArrayDictionary[e] = n, $("#" + e + " .AutoCompleteIcon").length > 0 || $("#" + e).siblings(".AutoCompleteIcon").length > 0) UpdateAutoCompleteDataSoure(e, n); else {AddAutoCompleteIcon(e), $("#" + e).autocomplete({source: n, minLength: 0, autoFocus: !1}); var l = $("#" + e).parent(); BlindEvent($("#" + e), {click: function () {$("#" + e).autocomplete("search", ""), Element.AddClass($(".AutoCompleteIcon", $(l)), "Hidden")}, blur: function () {Element.RemoveClass($(".AutoCompleteIcon", $(l)), "Hidden")}}), void 0 !== a && null != a ? $("#" + e).on("autocompletechange", function () {$("#" + e).fireEvent("change"), a.call(this, document.getElementById(e).value)}) : $("#" + e).on("autocompletechange", function () {$("#" + e).fireEvent("change")}), window.setTimeout(function () {$("ul.ui-autocomplete").css("display", "none")}, 800)} } catch (r) { } } function AddAutoCompleteIcon(e) { } function UpdateAutoCompleteDataSoure(e, n) {$("#" + e).autocomplete({source: n})} function RemoveAutoComplete(e) {try {$("#" + e).autocomplete("destroy")} catch (n) { } } function InitiateAutoCompleteByReadDataBase(e, n, o, a, l, r, s, c) {void 0 === s && (s = ""), void 0 === c && (c = 50); var d = ""; PageParameterObject.IsMobile && PageDynamicObject.hasOwnProperty("MobileUserToken") && PageDynamicObject.MobileUserToken.length > 0 && (d = PageDynamicObject.MobileUserToken); var u = "Ajax/Task/ReadDataFromDataBaseForAutoComplete.aspx?MobileUserToken=" + d + "&IsSystemFrameWork=" + e + "&ColumnName=" + encodeURIComponent(n) + "&sql=" + encodeURIComponent(o) + "&SearchColumnList=" + encodeURIComponent(s) + "&MaxResult=" + c + "&Version=" + Math.random(); if ($("#" + a + " .AutoCompleteIcon").length > 0 || $("#" + a).siblings(".AutoCompleteIcon").length > 0) UpdateAutoCompleteDataSoure(a, u); else {AddAutoCompleteIcon(a), $("#" + a).autocomplete({source: u, minLength: 0, autoFocus: !1}); var p = $("#" + a).parent(); BlindEvent($("#" + a), {click: function () {$("#" + a).autocomplete("search", ""), Element.AddClass($(".AutoCompleteIcon", $(p)), "Hidden")}, blur: function () {Element.RemoveClass($(".AutoCompleteIcon", $(p)), "Hidden")}}), void 0 !== r && null != r ? $("#" + a).on("autocompletechange", r) : $("#" + a).on("autocompletechange", function () {$("#" + a).fireEvent("change")}), window.setTimeout(function () {$("ul.ui-autocomplete").css("display", "none")}, 800)} } function UpdateDivContentByID(e, n) {UpdateDivContent($("#" + e), n)} function UpdateDivContent(e, n) {try {e.html(n)} catch (o) { } } function NewGuid() {var e = function () {return ((1 + Math.random()) * 65536 | 0).toString(16).substring(1)}; return e() + e() + "-" + e() + "-" + e() + "-" + e() + "-" + e() + e() + e()} function SortArray(e) {var n = j = t = 0; for (n = 0; n < e.length; n++)for (j = 0; j < e.length; j++)e[n] < e[j] && (t = e[n], e[n] = e[j], e[j] = t); return e} function CloseWindow() {if (IsInIframe()) window.parent.PageRightContentSliderClass.Close(); else try {IsClientMode ? WinFormClass.CloseNewWindow() : window.close()} catch (e) {alert(e.toString()); try {CloseMobileWindowCore()} catch (n) { } } } function CloseMobileWindow() {CloseMobileWindowCore()} function CloseMobileWindowCore() {window.location.href = window.location.href + "#closemobilewindow"} function BlindEvent(e, n) {e.bind(n)} function UnBlindEvent(e, n) {e.unbind(n)} function BlindEnterEvent(element, EnterCallBack) {BlindEvent(element, {keydown: function (event) {if (13 == parseInt(event.keyCode)) try {EnterCallBack.call(this, event)} catch (e) {eval(EnterCallBack)} }})} function BlindMouseEnterLeaveShowEvent(elements, ChildElementCSSName, CallBack) {elements.each(function (index, item) {BlindEvent($(item), {mouseenter: function (event) {Element.SetStyle($(item).find("." + ChildElementCSSName), "visibility", "visible"), void 0 !== CallBack && eval(CallBack)}, mouseleave: function (event) {Element.SetStyle($(item).find("." + ChildElementCSSName), "visibility", "hidden"), void 0 !== CallBack && eval(CallBack)}})})} function OnEnterEvent(event, EnterCallBack) {13 == parseInt(event.keyCode) && eval(EnterCallBack)} function GetToday() {return new Date().format("yyyy-MM-dd")} function GetTodayCN() {return new Date().format("yyyy年MM月dd日")} function GetNow() {return new Date().format("yyyy-MM-dd hh:mm:ss")} function GetNewDay(e, n) {return new Date(Date.parse(e) + 864e5 * n).format("yyyy-MM-dd")} $.fn.extend({tap: function (e) {BlindEvent(this, {tap: e})}, foreach: function (e) {for (var n = 0, o = this.length; n < o; n++)e.call(this, this[n], n)}, fireEvent: function (e) {this.trigger(e)}}), $.prototype.value = function () {return this.val()}, Date.prototype.format = function (e) {var n = {"M+": this.getMonth() + 1, "d+": this.getDate(), "h+": this.getHours(), "m+": this.getMinutes(), "s+": this.getSeconds(), "q+": Math.floor((this.getMonth() + 3) / 3), S: this.getMilliseconds()}; for (var o in /(y+)/.test(e) && (e = e.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length))), n) RegExp("(" + o + ")").test(e) && (e = e.replace(RegExp.$1, 1 == RegExp.$1.length ? n[o] : ("00" + n[o]).substr(("" + n[o]).length))); return e}, Object.HasValue = function (e) {if (null == e) return !1; for (var n in e) return !0; return !1}, Object.merge = function (e, n) {return $.extend({}, e, n)}, Object.Length = function (e) {if (null == e) return 0; var n = 0; for (var o in e) n++; return n}, Object.Keys = function (e) {if (null == e) return null; var n = []; for (var o in e) Array.include(n, o); return n}, Object.Values = function (e) {if (null == e) return null; var n = []; for (var o in e) Array.include(n, e[o]); return n}, Object.ToQueryString = function (e) {return $.param(e)}, Object.Clone = function (e) {var n = {}; if (null == e) n = null; else for (var o in e) n[o] = e[o]; return n}, Array.indexOf || (Array.prototype.indexOf = function (e) {for (var n = 0; n < this.length; n++)if (this[n] == e) return n; return -1}), Array.prototype.foreach = function (e) {for (var n = 0, o = this.length; n < o; n++)e.call(this, this[n], n)}, Array.prototype.each = function (e) {for (var n = 0, o = this.length; n < o; n++)e.call(this, this[n], n)}, Array.prototype.last = function () {return this != null && this.length > 0 ? this[this.length - 1] : null}, Array.prototype.toJSON = function () {for (var e = {}, n = 0; n < this.length; n++)e[this[n]] = this[n]; return e}, Array.remove = function (e, n) {e.splice(e.indexOf(n), 1)}, Array.removeat = function (e, n) {e.splice(n, 1)}, Array.contains = function (e, n) {return e.indexOf(n) >= 0}, Array.index = function (e, n) {return e.indexOf(n)}, Array.include = function (e, n) {return e.push(n)}, Array.GetSqlString = function (e) {var n = []; return e.length > 0 && e.foreach(function (e, o) {Array.include(n, "'" + e.replace(/'/ig, "danyinghao") + "'")}), n.join(",")}, Array.GetValuesByKey = function (e, n) {var o = ""; if (void 0 !== e) {var a = []; e.foreach(function (e, o) {e.hasOwnProperty(n) && !Array.contains(a, e[n]) && Array.include(a, e[n])}), o = a.join(",")} return o}, Array.GetListByKey = function (e, n) {var o = []; return void 0 !== e && e.foreach(function (e, a) {e.hasOwnProperty(n) && !Array.contains(o, e[n]) && Array.include(o, e[n])}), o}, JSON.encode = function (e) {return JSON.stringify(e)}, JSON.decode = function (e) {return JSON.parse(e)}, JSON.EncodeObjectList = function (e) {if (null == e || 0 == e.length) return "[]"; var n = []; return e.foreach(function (e, o) {Array.include(n, JSON.encode(e))}), "[" + n.join(",") + "]"}, String.trim = function (e) {return $.trim(e)}, String.prototype.chunk = function (e) {if (0 == this.length) return []; if (!(this.length > e)) return [this.toString()]; for (var n = [], o = parseInt(this.length / e) + 1, a = 0; a < o; a++) {var l = !1, r = a * e, s = (a + 1) * e; if (s >= this.length && (s = this.length, l = !0), s > r) Array.include(n, this.substring(r, s)); else break; if (l) break} return n}, Date.parser = function (e, n) {return new Date(Date.parse(e, ""))}, Date.ConvertValidDate = function (e) {var n = document.getElementById(e).value; n.length > 0 && 0 > n.indexOf("1900") && (document.getElementById(e).value = new Date(n).format("yyyy-MM-dd"))}, Date.NewDate = function (e) {return new Date(e.replace(/-/ig, "/"))}, Date.DateDiff = function (e, n) {var o, a = new Date(n.replace(/-/ig, "/")).getTime() - new Date(e.replace(/-/ig, "/")).getTime(), l = Math.floor(a / 864e5), r = a % 864e5, s = Math.floor(r / 36e5), c = r % 36e5; return {天: l, 时: s, 分: Math.floor(c / 6e4), 秒: Math.round(c % 6e4 / 1e3)}}, Date.MonthDiff = function (e, n) {var o; return e = new Date(e), o = ((n = new Date(n)).getFullYear() - e.getFullYear()) * 12, o -= e.getMonth(), (o += n.getMonth()) <= 0 ? 0 : o}, Date.CompareMinDate = function (e, n, o, a) {var l = Element.GetValue($("#" + e)), r = Element.GetValue($("#" + n)); l.length > 0 && r.length > 0 && Date.NewDate(l) > Date.NewDate(r) && (PopupToastMessage("info", a + "不允许小于" + o), Element.SetValue($("#" + n), ""))}, "undefined" == typeof Element && (Element = {}), Element.GetValue = function (e) {return e.val()}, Element.SetValue = function (e, n) {e.val(n), e.fireEvent("change")}, Element.GetChildTableValue = function (e, n) {$("." + n).foreach(function (n, o) {if (n.id.indexOf("_" + e) > 0) return n.value})}, Element.SetChildTableValue = function (e, n, o) {$("." + n).foreach(function (n, a) {n.id.indexOf("_" + e) > 0 && (n.value = o)})}, Element.checked = function (e) {return e.is(":checked")}, Element.check = function (e, n) {e.prop("checked", n)}, Element.disabled = function (e) {return e.is(":disabled")}, Element.disable = function (e, n) {e.prop("disabled", n)}, Element.SetStyle = function (e, n, o) {e.css(n, o)}, Element.HasClass = function (e, n) {return e.hasClass(n)}, Element.AddClass = function (e, n) {return e.addClass(n)}, Element.RemoveClass = function (e, n) {return e.removeClass(n)}, Element.Size = function (e) {return {width: e.width(), height: e.height()}}, Element.GetStyle = function (e, n) {return e.css(n)}, Element.SetStyle = function (e, n, o) {return e.css(n, o)}, Element.GetAttribute = function (e, n) {return e.attr(n)}, Element.SetAttribute = function (e, n, o) {return e.attr(n, o)}, Element.RemoveAttribute = function (e, n) {return e.removeAttr(n)}, Element.InsertBefore = function (e, n) {$(n).insertBefore("#" + e)}, Element.InsertBeforeByElement = function (e, n) {return $(n).insertBefore(e)}, Element.GetElementName = function (e) {return e.prop("nodeName").toLocaleLowerCase()}, Element.Append = function (e, n) {$("#" + e).append(n)}, Element.AppendByElement = function (e, n) {e.append(n)}, Element.AppendAfter = function (e, n) {$("#" + e).after(n)}, Element.AppendAfterByElement = function (e, n) {return e.after(n)}, Element.Remove = function (e) {try {$("#" + e).remove()} catch (n) { } }, Element.RemoveByElement = function (e) {try {e.remove()} catch (n) { } }, Element.Position = function (e) {try {var n = $("#" + e).offset(); return {x: n.left, y: n.top}} catch (o) { } }, Element.PositionByElement = function (e) {try {var n = e.offset(); return {x: n.left, y: n.top}} catch (o) { } }, Element.GetHtml = function (e) {return e.html()}, Element.SetHtml = function (e, n) {return e.html(n)}, Element.GetText = function (e) {return e.text()}, Element.SetText = function (e, n) {return e.text(n)}, Element.IsSupportPlaceHolder = function (e) {return void 0 !== e.placeholder}, Element.DisableCopy = function (e) {void 0 === e && (e = $(document.body)), BlindEvent(e, {paste: function () {return !1}, drop: function () {return !1}, cut: function () {return !1}, copy: function () {return !1}, contextmenu: function () {return !1}}), Element.SetStyle(e, "user-select", "none"), Element.SetStyle(e, "-ms-user-select", "none"), Element.SetStyle(e, "-moz-user-select", "none"), Element.SetStyle(e, "-webkit-user-select", "none"), Element.SetStyle(e, "-webkit-touch-callout", "none")}, Element.PlaceHolder = function (e) {if (void 0 !== e.placeholder) return e.placeholder; var n = RegexClass.GetRegExpValue(/placeholder=.*?\s+/i, e.outerHTML); return n.length > 0 ? n = String.trim(n.replace(/^placeholder=/i, "")) : (n = RegexClass.GetRegExpValue(/placeholder=.*?>/i, e.outerHTML)).length > 0 && (n = String.trim(n.replace(/^placeholder=/i, "").replace(">", ""))), n}; var ScrollBarClass = {Initiate: function (e, n) {try {void 0 === n || null == n ? e.niceScroll() : e.niceScroll(n)} catch (o) { } }, Resize: function (e) {try {e.getNiceScroll().resize()} catch (n) { } }}, PlaySound = {TimerObject: {}, Play: function (e, n) {try {var o = document.getElementById(e); null != o && o.Play(), void 0 !== n && null != n && (this.TimerObject[e] = setInterval(function () {(0 == o.playState || 8 == o.playState) && (window.clearInterval(PlaySound.TimerObject[e]), delete PlaySound.TimerObject[e], n.call(this))}, 1e3))} catch (a) {alert(a.message)} }, Pause: function (e) {try {var n = document.getElementById(e); null != n && n.Pause()} catch (o) {alert(o.message)} this.TimerObject.hasOwnProperty(e) && (window.clearInterval(this.TimerObject[e]), delete this.TimerObject[e])}, Stop: function (e) {try {var n = document.getElementById(e); null != n && n.Stop()} catch (o) {alert(o.message)} this.TimerObject.hasOwnProperty(e) && (window.clearInterval(this.TimerObject[e]), delete this.TimerObject[e])}, TooglePlayPause: function (e, n) {var o = $(n); Element.HasClass(o, "Play") ? (Element.RemoveClass(o, "Play"), Element.AddClass(o, "Pause"), this.Play(e, function () {PlaySound.TooglePlayPause(e, n)})) : (Element.RemoveClass(o, "Pause"), Element.AddClass(o, "Play"), this.Stop(e))}}; function ContextMenu(e, n, o, a, l) {var r = null == e || 0 == e.length ? $(document) : $("#" + e); ContextMenuCore(r, n, o, a, l)} function ContextMenuCore(e, n, o, a, l) {var r = e, s = $(o).jqxMenu({width: "220px", autoOpenPopup: !1, mode: "popup", theme: "arctic"}); if (void 0 !== a && a) {var c = Element.PositionByElement(r); void 0 === l && (l = {Width: 0, Height: 0}), BlindEvent(r, {click: function (n) {return s.jqxMenu("open", parseInt(c.x) + l.Width, parseInt(c.y) + Element.Size(e).height + l.Height), !1}})} else BlindEvent(r, {mouseup: function (e) {if (IsRightClick(e) || $.jqx.mobile.isTouchDevice()) {var n = $(window).scrollTop(), o = $(window).scrollLeft(); return s.jqxMenu("open", parseInt(e.clientX) + 5 + o, parseInt(e.clientY) + 5 + n), !1} }}), DisablePageContextMenu()} function InitiateImageZoom(e) {if (e.length > 0) try {$(e).zoomify()} catch (n) { } } var IsPageContextMenuDisabled = !1; function DisablePageContextMenu() { } function DisablePageContextMenuCore() { } function CreateDropDownListButton(e, n, o, a, l) {$(e).jui_dropdown({launcher_id: o, launcher_container_id: n, menu_id: a, launcher_is_UI_button: !1, onSelect: function (e, n) {void 0 !== l && null != l && l(n)}})} function GetValueFromQueryString(e, n) {var o = ParseQueryStringToJSON(n); return o.hasOwnProperty(e) ? o[e] : ""} function ParseQueryStringToJSON(e) {var n = {}; (void 0 === e || 0 == e.length) && (e = window.location.href); var o = e.split("?"); return o.length > 1 && o.last().split("&").each(function (e, o) {var a = e.split("="); a.length > 1 && (n[a[0]] = a.last())}), n} function IsRightClick(e) {var n; if (!e) var e = window.event; return e.which ? n = 3 == e.which : e.button && (n = 2 == e.button), n} function GetLoadingMsg(e) {return LoaderImg + e} function GetErrorMsgHTML(e) {return '<div class="ErrorMsgDIV"><div class="ErrorMsgInnerDIV">' + e + "</div></div>"} function GetAlertMsgHTML(e) {return '<div class="AlertMsgDIVNew">' + e + "</div>"} function GetSuccessMsgHTML(e) {return '<div class="ProcessSuccessMsgDIV20">' + e + "</div>"} function GetPhotoHTML(e) {return (0 == e.length || e.indexOf(">--<") > 0) && (e = "image/nophotoproduct.png"), '<div class="PhotoDIV"><div class="PhotoInnerDIV"><a target="_blank" href="' + e + "\"><img style='width:90px;' src=\"" + e + '"></a></div></div>'} function OpenNewWindow(e, n, o, a, l) {IsClientMode ? WinFormClass.OpenNewWindow(e, n, o, !1, a, l) : PopUp(o, "", a, l, "yes")} function OpenMaximizedWindow(e, n, o) {0 > o.toLowerCase().indexOf("http") && (o = PageParameterObject.SystemFrameWorkBaseURL + "/" + o), IsClientMode ? WinFormClass.OpenNewWindow(e, n, o, !0) : window.open(o)} function OpenIframeInnerWindow(e, n, o) {null != CommonManagementClass.timer && (window.clearTimeout(CommonManagementClass.timer), CommonManagementClass.timer = window.setTimeout(function () {Element.Remove("PageTaskWindowIframeStatusDIV"), Element.RemoveClass($("#PageTaskWindowIframe"), "Hidden"), HideLoadingStatusDIV()}, 3e3)), PageRightContentSliderClass.Show(Element.Size($(".main-container-inner")).width, "<div id='PageTaskWindowIframeStatusDIV' style='padding:10px;'>" + GetLoadingMsg("正在加载...") + "</div><iframe style='width:100%; height:99%; border:0px;' id='PageTaskWindowIframe' src='" + o + "' class='Hidden'></iframe>", !0, "#fff"), Element.SetStyle($("#PageRightContentSliderContentDIV"), "padding", "0px"), BlindEvent($("#PageTaskWindowIframe"), {load: function () {Element.Remove("PageTaskWindowIframeStatusDIV"), Element.RemoveClass($("#PageTaskWindowIframe"), "Hidden"), HideLoadingStatusDIV()}})} function WindowFocus() {window.focus()} function GetParentWindow() {var e = null; try {e = void 0 === window.dialogArguments ? window.opener : window.dialogArguments} catch (n) {e = window.opener} return e} function PopUp(e, n, o, a, l) {PopUpEx(e, n, o, a, l)} function PopUpEx(e, n, o, a, l) {var r = (window.screen.availHeight - 30 - a) / 2, s = (window.screen.availWidth - 10 - o) / 2; try {var c = "width=" + o + ",height=" + a + ",top=" + r + ",left=" + s + ",scrollbars=" + (void 0 === l ? "auto" : l), d = window.open(e, n, c)} catch (u) {var c = "width=" + o + ",height=" + a + ",top=" + r + ",left=" + s + ",scrollbars=" + (void 0 === l ? "auto" : l), d = window.open(e, "NewWindow", c)} return d} function PopupDialog(e, n, o, a) {if (window.showModalDialog) return window.showModalDialog(e, n, "dialogWidth:" + o + "px;dialogHeight:" + a + "px;help:no;scroll:auto;resizable:no;center:yes"); try {return window.open(e, n, "height=" + a + ",width=" + o + ",toolbar=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no ,modal=yes")} catch (l) {return window.open(e, "", "height=" + a + ",width=" + o + ",toolbar=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no ,modal=yes")} } function BackToTop() {window.scrollTo(0, 0)} function CallPhoneNumber(e) {window.location.href = "tel:" + e} function Download(e, n) {IsClientMode ? WinFormClass.Download(e, n) : window.open(n)} function ViewSaleWeiXin() {var e = ""; e += "<div class='NoticeDIV' style='margin-top:5px;'>", e += "您有任何系统问题及建议，请提交售后工单给我们。企管宝团队全心为您服务！", e += "</div>", e += "<div class='Center' style='margin-top:20px;'>" + (UserInfo.UserGuid == NullGuid ? "<a href=\"CustomerServiceTicket.aspx\" class='RoundLinkSmallButtonGreyPaddingBigNewBlue' target='_blank'>提交售后工单</a>&nbsp;&nbsp;" : "") + '<a href="http://www.qiguanbao.com" target="_blank" class=\'RoundLinkSmallButtonGreyPaddingBigNewBlue\'>企管宝官网</a></div>', e += "<div class='Relative' style='margin-top:20px;'>", e += "<div class='Absolute' style='top:5px;'><img src='image/weixin.png' style='width:100px;' /></div>", e += "<div class='Absolute' style='left:130px; width:310px; top:10px;'>", e += "<div class='GreenBigTitleDIV' style='font-size:13px; font-weight:bold; line-height:22px;'>售后问题别担心，企管宝为您提供周到的售后支持！</div>", e += "<div style='margin-top:15px; line-height:18px; color:#888;'>请添加企管宝官方微信号，将您遇到或想要咨询的问题、意见或建议通过微信发送给我们。我们的售后工程师将及时为您服务！</div>", e += "</div>", PopupDialogWindow("", "添加售后微信", !0, !0, !0, 500, 250, "<div id='ViewSaleWeiXinDIV'>" + (e += "</div>") + "</div>", "destroy")} function ViewAttachmentFile(e, n, o) {"png" == n || "jpg" == n || "gif" == n || "jpeg" == n ? (PopupDialogModelWindow(400), PopupDialogModelWindowSetTitle("预览图片"), PopupDialogModelWindowSetContent(GetLoadingMsg("正在加载...")), window.setTimeout(function () {var n = Element.Size($(".V5PopupContentDIV")).width; PopupDialogModelWindowSetContent("<div style='text-align:center;' class='HandCursor' onclick=\"OpenMaximizedWindow(false, '查看附件', '" + e + '\')"><img src="' + e + "\" style='border-radius:5px; width:" + n + "px;' id='ViewAttachmentFileImage'></div>")}, 1e3)) : OpenMaximizedWindow(!1, "查看附件", e)} function CreateToogleObject(e) {if (DomHasElement(e)) {var n = document.getElementById(e); if (!Element.IsSupportPlaceHolder(n)) {var o = Element.PlaceHolder(n); o.length > 0 && (o = o.replace(/^\"|\"$/ig, ""), BlindEvent($("#" + e), {focus: function () {n.value == o && (n.value = "")}, blur: function () {0 == String.trim(n.value).length && (n.value = o)}})), 0 == String.trim(n.value).length && (n.value = o)} } } function modalWin(e, n, o, a) {PopUpEx(e, n, o, a, "yes")} function modalWinNew(e, n, o, a) {return window.showModalDialog ? window.showModalDialog(e, window, "dialogWidth:" + o + "px;dialogHeight:" + a + "px;help:no;scroll:auto;resizable:no;center:yes") : window.open(e, window, "height=" + a + ",width=" + o + ",toolbar=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no ,modal=yes")} function GetXMLNodeValue(e, n) {var o = "", a = "<" + e + ">", l = n.indexOf(a), r = "</" + e + ">", s = n.indexOf(r, l); return l >= 0 && s > 0 && (o = n.substring(l + a.length, s)), o} function WindowOpenerReload() {window.opener.location.reload()} function MaxWindow() {IsClientMode ? WinFormClass.MaxFormWindow() : (window.moveTo(0, 0), window.resizeTo(screen.availWidth, screen.availHeight), window.outerWidth = screen.availWidth, window.outerHeight = screen.availHeight)} function SetWorkFlowTitleAlignCenter() {Element.SetStyle($(".WorkFlowTitle"), "padding-left", "0px"), Element.SetStyle($("#WorkFlowExtraInfo"), "padding-left", "0px"), Element.SetStyle($(".WorkFlowTitle"), "text-align", "center"), Element.SetStyle($("#WorkFlowExtraInfo"), "text-align", "center")} function PageReplaceReload(e) {if (void 0 === e) PageReloadDO(); else {var n = ParseQueryStringToJSON(window.location.href); for (var o in e) n[o] = encodeURIComponent(e[o]); var a = []; for (var o in n) Array.include(a, o + "=" + n[o]); ShowLoadingStatusDIV(null, "正在加载..."), GoToURL(window.location.href.split("?")[0] + "?" + a.join("&"))} } function PageReload() {"undefined" == typeof ClientSocketIP ? PageReloadDO() : RemoveSocketOnlineUser("PageReloadDO", null)} function PageReloadDO() {window.location.href = window.location.href} function ChangeWindowTitle(e) {try {document.title = e} catch (n) { } } function GoToURL(e) {try {e.indexOf("<$MailServerSystemBaseURL$>") >= 0 && (e = e.replace("<$MailServerSystemBaseURL$>", PageParameterObject.MailServerSystemURL.replace("App.aspx", "")))} catch (n) { } window.location.href = e} function GoToURLDO(e) {window.location.href = e.NewURL} function RedirectUpgradeIEPage() {window.location.href = PageParameterObject.SystemFrameWorkBaseURL + "/UpgradeIE.html"} function GetServicePage(e, n, o, a) {if (void 0 === n && (n = ""), void 0 === o && (o = ""), void 0 === a) a = ""; else {var l = a.split("&"), r = []; l.foreach(function (e, n) {if (e.length > 0 && e.indexOf("=")) {var o = e.split("="); IsIE() ? Array.include(r, encodeURIComponent(o[0]) + "=" + encodeURIComponent(o[1])) : Array.include(r, o[0] + "=" + o[1])} }), a = "&" + r.join("&")} return PageParameterObject.SystemFrameWorkBaseURL + "/Service." + e + ".aspx?Method=" + n + "&MethodName=" + encodeURIComponent(o) + a} function LoadServicePage(e, n, o, a) {if (void 0 === n && (n = ""), void 0 === o && (o = ""), void 0 === a) a = ""; else {var l, r = a.split("&"), s = []; r.foreach(function (e, n) {if (e.length > 0 && e.indexOf("=")) {var o = e.split("="); IsIE() ? Array.include(s, encodeURIComponent(o[0]) + "=" + encodeURIComponent(o[1])) : Array.include(s, o[0] + "=" + o[1])} }), a = "&" + s.join("&")} GoToURL(PageParameterObject.SystemFrameWorkBaseURL + "/Service." + e + ".aspx?Method=" + n + "&MethodName=" + encodeURIComponent(o) + a)} function LoadServicePageNewWindow(e, n, o, a) {if (void 0 === n && (n = ""), void 0 === o && (o = ""), void 0 === a) a = ""; else {var l = a.split("&"), r = []; l.foreach(function (e, n) {if (e.length > 0 && e.indexOf("=")) {var o = e.split("="); IsIE() ? Array.include(r, encodeURIComponent(o[0]) + "=" + encodeURIComponent(o[1])) : Array.include(r, o[0] + "=" + o[1])} }), a = "&" + r.join("&")} var s = PageParameterObject.SystemFrameWorkBaseURL + "/Service." + e + ".aspx?Method=" + n + "&MethodName=" + encodeURIComponent(o) + a; OpenMaximizedWindow(!1, o, s)} function LoadServicePageNewWindowBySize(e, n, o, a, l, r, s) {if (void 0 === n && (n = ""), void 0 === o && (o = ""), void 0 === a) a = ""; else {var c = a.split("&"), d = []; c.foreach(function (e, n) {if (e.length > 0 && e.indexOf("=")) {var o = e.split("="); IsIE() ? Array.include(d, encodeURIComponent(o[0]) + "=" + encodeURIComponent(o[1])) : Array.include(d, o[0] + "=" + o[1])} }), a = "&" + d.join("&")} var u = PageParameterObject.SystemFrameWorkBaseURL + "/Service." + e + ".aspx?Method=" + n + "&MethodName=" + encodeURIComponent(o) + a; OpenNewWindow(l, o, u, r, s)} function LoadRelativePage(e) {var e = PageParameterObject.SystemFrameWorkBaseURL + "/" + e; GoToURL(e)} function GetCurrentDomain() {var e = window.location.href; return (e = (e = e.split("//")[1]).split("/")[0]).split(":")[0]} function SplitCurrentDomain(e) {return e = (e = (e = e.split("//")[1]).split("/")[0]).split(":")[0]} function RemoveSocketOnlineUser(e, n) {AjaxLoader(!1, "Ajax/User/RemoveSocketOnlineUser.aspx?Version=" + Math.random(), "", "", {ClientSocketIP: ClientSocketIP}, e, "", n)} function GetIframeWindow(e) {return document.getElementById(e).contentWindow} function GetSelectAllLink(e) {return "<a href=\"javascript:CheckAll('" + e + "')\"><u>全选</u></a>/<a href=\"javascript:UnCheckAll('" + e + "')\"><u>取消</u></a>"} function GetCheckAllObject(e, n, o) {return (void 0 === n && (n = !1), void 0 === o && (o = !0), 0 == e.indexOf("#") || 0 == e.indexOf(".")) ? "<input type='checkbox' onclick=\"this.checked?CheckAllByElement($('" + e + "')):UnCheckAllByElement($('" + e + "'))\" " + (n ? "checked='checked'" : "") + " />" + (o ? "全选" : "") : "<input type='checkbox' onclick=\"this.checked?CheckAll('" + e + "'):UnCheckAll('" + e + "')\" " + (n ? "checked='checked'" : "") + " />" + (o ? "全选" : "")} function CheckRangeValue(e, n, o) {if (e.value.length > 0 && (o || "-" != e.value)) {if (IsNumber(e.value)) {var a = parseFloat(e.value); n.hasOwnProperty("MinValue") && a < n.MinValue ? e.value = n.MinValue : n.hasOwnProperty("MaxValue") && a > n.MaxValue && (e.value = n.MaxValue)} else e.value = ""} } function IsNumber(e) {return /^-?\d*\.?\d*$/.test(e.replace(/,/ig, ""))} function IsInt(e) {return /^-?\d+$/.test(e)} function IsValidMobilePhone(e) {return /(^0{0,1}1[3|4|5|6|7|8|9][0-9]{9}$)/.test(e)} function IsPhoneNumber(e) {return /^([0-9-])+$/.test(e)} function IsValidEmail(e) {return /^([a-zA-Z0-9_.-])+@([a-zA-Z0-9_.-])+\.([a-zA-Z])+([a-zA-Z])+/.test(e)} function IsFullJSFunction(e) {return e.indexOf("(") >= 0 && /\)$/.test(e)} function IsValidFolderName(e) {return !/\\|\/|\:|\*|\?|\"|\<|\>|\|/ig.test(e) || (alert('文件夹名称不能包含下列任何字符:\n\\/:*?"<>|'), !1)} function IsValidGuid(e) {return /\b[a-f\d]{32}\b/ig.test(e)} function IsValidIPAddress(e) {return "::1" == e || /^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(e)} function IsBankNumber(e) {return /(^\d{16}$)|(^\d{19}$)/.test(e)} function IsPlateNumber(e) {return /^[京津沪渝冀豫云辽黑湘皖鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领A-Z]{1}[A-Z]{1}[A-Z0-9]{4}[A-Z0-9挂学警港澳]{1}$/.test(e)} function IsVehicleIdentificationNumber(e) {return /[A-Z0-9]{17}/.test(e)} function ConvertBool(e) {switch (e.toLowerCase()) {case "true": case "yes": case "1": return !0; case "false": case "no": case "0": case null: return !1; default: return Boolean(string)}} function PadLeft(e, n, o) {return (void 0 === o && (o = "0"), e.length >= n) ? e : PadLeft(o + e, n)} function PadRight(e, n, o) {return (void 0 === o && (o = "0"), e.length >= n) ? e : PadRight(e + o, n)} function ConvertNumber(e, n) {if (void 0 === n && (n = 2), e.length > 0) {var o = parseFloat(e); return o == NaN && (o = 0), n > 0 && (o = parseFloat(RoundNumber(o, n))), o} return 0} function CountLocationDistanceByPoint(e, n, o, a, l, r) {try {var s = 0, c = toRad(e), d = toRad(o), u = c - d, p = toRad(n) - toRad(a), s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(u / 2), 2) + Math.cos(c) * Math.cos(d) * Math.pow(Math.sin(p / 2), 2))); l.call(this, RoundNumber(6378137 * s / 1e3, 2))} catch (m) {r.call(this, m.toString())} } function toRad(e) {return e * Math.PI / 180} function 获取值(e) {return String.trim(document.getElementById(e).value)} function 获取样式值(e) {var n = $("." + e); return n.length > 0 ? Element.GetValue($(n[0])) : ""} function 填写值(e, n) {填写控件(e, n)} function 填写样式值(e, n) {Element.SetValue($("." + e), n)} function 获取数值(ElementID, DecimalLength) {var value = String.trim(document.getElementById(ElementID).value); if (value.length > 0) {var CellMoney = 0; return value.indexOf("+") >= 0 || value.indexOf("-") >= 0 || value.indexOf("*") >= 0 || value.indexOf("/") >= 0 ? (1 == value.length && (value += "0"), CellMoney = parseFloat(eval("(" + value + ")"))) : CellMoney = parseFloat(value), CellMoney == NaN && (CellMoney = 0), DecimalLength > 0 && (CellMoney = parseFloat(RoundNumber(CellMoney, DecimalLength))), CellMoney} return 0} function 填写控件(e, n) {try {if (n.length > 0 && n.indexOf("UserUploadFiles") > 0 && (n.indexOf("%3c%2fa%3e%3c%2fdiv%3e") > 0 || n.indexOf("%3cdiv%3e%3ca") >= 0 || n.indexOf("<div") >= 0)) {var o = decodeURIComponent(n), a = AddAttachmentByCompenentClass.GetFileAttachmentDictionary(o); AddAttachmentByCompenentClass.Config.TargetObjectID = e, AddAttachmentByCompenentClass.ClearFileList(), AddAttachmentByCompenentClass.AddTargetObjectIDValue(a)} else Element.SetValue($("#" + e), n)} catch (l) {alert("填写控件的值失败，原因：" + l.toString())} } function MustInputNumber(e) {var n = String.trim(e.value); n.length > 0 && !IsNumber(n) && (e.value = "")} function MustInputInt(e) {var n = String.trim(e.value); n.length > 0 && !IsInt(n) && (e.value = "")} function RoundNumber(e, n) {return e.toFixed(n)} function FormatQFZNumber(e) {return (Number(e).toFixed(2) + "").replace(/\d{1,3}(?=(\d{3})+(\.\d*)?$)/g, "$&,")} function PrintPreview() {IsClientMode ? WinFormClass.PrintPreview() : window.print()} function PrintContent(e) {e.print({globalStyles: !0, mediaPrint: !1, stylesheet: "css/print.css", noPrintSelector: ".no-print", iframe: !0, append: null, prepend: null, manuallyCopyFormValues: !0, deferred: $.Deferred(), timeout: 750, title: null, doctype: "<!doctype html>"})} function InitiateDefaultWorkFlowPrintPage() {ChangeWindowTitle("打印 - " + OriginDictionary.WorkFlowInstanceCode), $(".panel-body").length > 0 && $("#WorkFlowLogDataTableContainerDIV").length > 0 && Element.AppendByElement($($(".panel-body").last()), $("#WorkFlowLogDataTableContainerDIV")), BlindEvent($("#HideWorkFlowLogList"), {click: function () {Element.checked($("#HideWorkFlowLogList")) ? Element.AddClass($("#WorkFlowLogDataTableContainerDIV"), "Hidden") : Element.RemoveClass($("#WorkFlowLogDataTableContainerDIV"), "Hidden")}}), BlindEvent($("#IsWirePrinter"), {click: function () {Element.checked($("#IsWirePrinter")) ? Element.AddClass($(document.body), "WirePrinter") : Element.RemoveClass($(document.body), "WirePrinter")}})} function InitiateViewWorkFlowPage() {if ($(".panel").length > 0 && $("#WorkFlowLineContainerDIV").length > 0) {var e = $($(".panel")[0]); Element.AppendAfterByElement($($(".panel-heading", e)[0]), $("#WorkFlowLineContainerDIV"))} if ($(".panel").length > 0 && $("#WorkFlowLogContainerDIV").length > 0) {var e = $($(".panel").last()); Element.AppendByElement(e, $("#WorkFlowLogContainerDIV"))} } function OpenOrHideElement(e, n, o) {try {"hide" == e ? $("#" + n).css("display", "none") : $("#" + n).css("display", void 0 === o || 0 == o.length ? "block" : o)} catch (a) { } } function OpenOrHideTargetElement(obj, TargetElementID, SuccessCallBack) {var CurrentObject = $(obj); Element.HasClass(CurrentObject, "icon_down_20") ? (Element.RemoveClass(CurrentObject, "icon_down_20"), Element.AddClass(CurrentObject, "icon_up_20"), OpenOrHideElement("open", TargetElementID)) : (Element.RemoveClass(CurrentObject, "icon_up_20"), Element.AddClass(CurrentObject, "icon_down_20"), OpenOrHideElement("hide", TargetElementID)), void 0 !== SuccessCallBack && SuccessCallBack.length > 0 && eval(SuccessCallBack)} function OpenOrHideElementByCssName(e, n, o) {try {"hide" == e ? $("." + n).css("display", "none") : $("." + n).css("display", void 0 === o || 0 == o.length ? "block" : o)} catch (a) { } } function OpenOrHideElementByElement(e, n, o) {try {"hide" == e ? n.css("display", "none") : n.css("display", void 0 === o || 0 == o.length ? "block" : o)} catch (a) { } } function 显示元素(e) {Element.RemoveClass($("#" + e), "Hidden")} function 隐藏元素(e) {Element.AddClass($("#" + e), "Hidden")} function CreateExpandCollapsePlaceHolder(e, n, o, a, l, r) {var s = ""; s += "<div class='ExpandCollapsePlaceHolder' id=\"" + o + '">', s += "<div class='TitlePlaceHolder' id=\"" + o + 'TitleDIV">' + a + "<span class='mui-icon mui-icon-" + (n ? "arrowup" : "arrowdown") + "'></span></div>", s += "<div class='ContentPlaceHolder " + (n ? "" : "Hidden") + "' id=\"" + o + 'ContentDIV">' + l + "</div>", s += "</div>", Element.AppendByElement(e, s), BlindEvent($("#" + o + "TitleDIV"), {click: function () {var e = $("#" + o + "TitleDIV .mui-icon"), n = $("#" + o + "ContentDIV"); $("#" + o + "TitleDIV .mui-icon-arrowup").length > 0 ? (Element.AddClass(n, "Hidden"), Element.AddClass(e, "mui-icon-arrowdown"), Element.RemoveClass(e, "mui-icon-arrowup")) : (Element.RemoveClass(n, "Hidden"), Element.RemoveClass(e, "mui-icon-arrowdown"), Element.AddClass(e, "mui-icon-arrowup"))}})} function InitiateExpandCollapse(e, n, o, a, l, r, s) {if (void 0 === l && (l = !1), void 0 === r && (r = !0), void 0 === s && (s = ""), DomHasElement(n)) {var c = $("#" + n); e ? (document.getElementById(n).innerHTML = r ? s.length > 0 ? s : "收起" : "", Element.AddClass(c, "icon_up_small" + (l ? "_double" : "")), OpenOrHideElement("open", o)) : (document.getElementById(n).innerHTML = r ? s.length > 0 ? s : "展开" : "", Element.AddClass(c, "icon_down_small" + (l ? "_double" : "")), OpenOrHideElement("hide", o)), BlindEvent(c, {click: function () {Element.HasClass(c, "icon_down_small" + (l ? "_double" : "")) ? (document.getElementById(n).innerHTML = r ? s.length > 0 ? s : "收起" : "", Element.RemoveClass(c, "icon_down_small" + (l ? "_double" : "")), Element.AddClass(c, "icon_up_small" + (l ? "_double" : "")), OpenOrHideElement("open", o), void 0 !== a && null != a && a.call(this, !0)) : (document.getElementById(n).innerHTML = r ? s.length > 0 ? s : "展开" : "", Element.RemoveClass(c, "icon_up_small" + (l ? "_double" : "")), Element.AddClass(c, "icon_down_small" + (l ? "_double" : "")), OpenOrHideElement("hide", o), void 0 !== a && null != a && a.call(this, !1)); try {PageMainContentResized()} catch (e) { } }})} } function InitiateCompleteRatio(e) {e.foreach(function (e, n) {var o = Element.GetText($(e)); $(e).percircle({percent: parseInt(o.split("%")[0])})})} function InitiateHtmlEditorByElement(e) {$("textarea", e).foreach(function (e, n) {if (Element.HasClass($(e), "HtmlEditor")) try {InitHtmlEditor(e.id, Element.Size($(e)).height, "", !0)} catch (o) { } })} function InitiateExpandCollapseByCSS(e, n, o, a, l, r, s) {if (void 0 === l && (l = !1), void 0 === r && (r = !0), void 0 === s && (s = ""), DomHasElement(n)) {var c = $("#" + n); e ? (document.getElementById(n).innerHTML = r ? s.length > 0 ? s : "收起" : "", Element.AddClass(c, "icon_up_small" + (l ? "_double" : "")), 显示元素(o)) : (document.getElementById(n).innerHTML = r ? s.length > 0 ? s : "展开" : "", Element.AddClass(c, "icon_down_small" + (l ? "_double" : "")), 隐藏元素(o)), BlindEvent(c, {click: function () {Element.HasClass(c, "icon_down_small" + (l ? "_double" : "")) ? (document.getElementById(n).innerHTML = r ? s.length > 0 ? s : "收起" : "", Element.RemoveClass(c, "icon_down_small" + (l ? "_double" : "")), Element.AddClass(c, "icon_up_small" + (l ? "_double" : "")), 显示元素(o), void 0 !== a && null != a && a.call(this, !0)) : (document.getElementById(n).innerHTML = r ? s.length > 0 ? s : "展开" : "", Element.RemoveClass(c, "icon_up_small" + (l ? "_double" : "")), Element.AddClass(c, "icon_down_small" + (l ? "_double" : "")), 隐藏元素(o), void 0 !== a && null != a && a.call(this, !1)); try {PageMainContentResized()} catch (e) { } }})} } function InitiateOpenOrHideCRMFunctionList(e) {$(".CRMMenuContainer .TitleDIV").foreach(function (e, n) {var o = e.id.replace("CRMMenuTitleDIV", ""), a = o + "DIV", l = "CRMMenuControlTitleDIV" + o; Element.Append(e.id, "<div id='" + l + "' class='CRMMenuControlTitleDIV'></div>"), InitiateExpandCollapse(!1, l, a, function () { }, !1, !1)})} function JSON2Str(e) {var n = [], o = function (e) {return "object" == typeof e && null != e ? JSON2Str(e) : /^(string|number)$/.test(typeof e) ? "'" + e + "'" : e}; for (var a in e) n.push("'" + a + "':" + o(e[a])); return "{" + n.join(",") + "}"} function DomHasElement(e) {try {var n = document.getElementById(e); if (null != n) return !0; return !1} catch (o) {return !1} } function getDocHeight() {var e = document; return Math.max(Math.max(e.body.scrollHeight, e.documentElement.scrollHeight), Math.max(e.body.offsetHeight, e.documentElement.offsetHeight), Math.max(e.body.clientHeight, e.documentElement.clientHeight))} function GetDocumentSize() {return Element.Size($(document))} function GetInputElementValueByID(e) {return GetInputElementValue($("#" + e))} function GetInputElementValue(e) {return String.trim(e.val())} function SetInputElementValueByID(e, n) {return SetInputElementValue($("#" + e), n)} function SetInputElementValue(e, n) {return e.val(n)} function GetSelectOptionText(e) {var n = document.getElementById(e); return -1 == n.options.selectedIndex ? "" : n.options[n.options.selectedIndex].text} function GetCheckBoxValue(e) {var n = []; return $("." + e).foreach(function (e, o) {e.checked && void 0 !== e.value && n.push(e.value)}), n} function GetCheckBoxValueByElement(e) {var n = []; return e.foreach(function (e, o) {e.checked && void 0 !== e.value && n.push(e.value)}), n} function GetRadioValue(e) {var n = "", o = document.getElementsByName(e); for (i = 0; i < o.length; i++)o[i].checked && (n = o[i].value); return n} function GetRadioValueByCSSName(e) {var n = ""; return $("." + e).foreach(function (e, o) {e.checked && (n = e.value)}), n} function SelectRadio(e, n) {var o = document.getElementsByName(e); for (i = 0; i < o.length; i++)o[i].value == n && (o[i].checked = !0)} function SelectRadioByCSSName(e, n) {$("." + e).foreach(function (e, o) {e.value == n && (e.checked = !0)})} function ClearRadioSelect(e) {var n = document.getElementsByName(e); for (i = 0; i < n.length; i++)if (n[i].checked) {n[i].checked = !1; break} } function ClearRadioSelectByCSSName(e) {$("." + e).foreach(function (e, n) {e.checked && (e.checked = !1)})} function BlindLinkageColumn(e, n) {var o = "", a = e.id.split("_"); o = 3 == a.length ? a[0] + "_" + n.TargetColumnName + "_" + a.last() : a[0] + "_" + n.TargetColumnName; var l = Element.GetValue($("#" + o)); if (DomHasElement(o)) {var r = n.Sql + (n.Sql.toLowerCase().indexOf(" where ") >= 0 ? " and " : " where ") + " " + n.ParentDataBaseColumnName + "='" + e.value + "' "; "TextField" == n.TargetColumnObjectType ? InitiateAutoCompleteByReadDataBase(n.IsSystemFrameWork, n.KeyColumnName, r, o) : AjaxAddOptionForSelectObject(n.IsSystemFrameWork, n.KeyColumnName, n.ValueColumnName, r, o, !0, !0, l, !0, "")} } function SetMetroSelectValue(ObjectID, Value, SuccessCallBack) {if (DomHasElement(ObjectID)) {var LinkageColumnObject = document.getElementById(ObjectID); if (LinkageColumnObject.value = Value, 1 == $("#" + ObjectID).parents(".rule-single-select").length) {var html = LinkageColumnObject.outerHTML, LinkageColumnContainer = $("#" + ObjectID).parents(".HtmlControlDIV"), AdditionalMsg = "", AdditionalMsgObject = LinkageColumnContainer.children(".AdditionalMsg"); 1 == AdditionalMsgObject.length && (AdditionalMsg = AdditionalMsgObject.html()), LinkageColumnContainer.innerHTML = '<div class="rule-single-select">' + html + "</div><span class='ClearFloat'></span>" + (AdditionalMsg.length > 0 ? '<span class="AdditionalMsg">' + AdditionalMsg + "</span>" : ""), LinkageColumnContainer.children(".rule-single-select").ruleSingleSelect()} else Element.SetValue($("#" + ObjectID), Value); void 0 !== SuccessCallBack && SuccessCallBack.length > 0 && eval(SuccessCallBack)} } function SetMetroRadioText(ObjectName, Value, SuccessCallBack) {var ObjectID = ObjectName + "ListDIV"; if (DomHasElement(ObjectID)) {var HasMatch = !1, MatchElement = null; $("#" + ObjectID + " .boxwrap a").foreach(function (e, n) {e.innerHTML == Value && (HasMatch = !0, MatchElement = e)}), HasMatch && $(MatchElement).fireEvent("click"), void 0 !== SuccessCallBack && SuccessCallBack.length > 0 && eval(SuccessCallBack)} } function InitiateSwitchCheckBox(e, n, o, a, l) {e.lc_switch(n, o), BlindEvent(e, {"lcs-on": function () {a.call(this)}, "lcs-off": function () {l.call(this)}})} function CheckSwitchCheckBox(e) {e.lcs_on()} function UnCheckSwitchCheckBox(e) {e.lcs_off()} function DestroySwitchCheckBox(e) {e.lcs_destroy()} function CheckAll(e) {$("." + e).foreach(function (e, n) {e.disabled || e.checked || Element.check($(e), !0)})} function CheckAllByElement(e) {e.foreach(function (e, n) {e.disabled || e.checked || Element.check($(e), !0)})} function UnCheckAll(e) {$("." + e).foreach(function (e, n) {!e.disabled && e.checked && Element.check($(e), !1)})} function UnCheckAllByElement(e) {e.foreach(function (e, n) {!e.disabled && e.checked && Element.check($(e), !1)})} function BulkSetValue(e, n, o, a) {$("." + e).foreach(function (e, l) {try {o && e.readonly || a && e.disabled || Element.SetValue($(e), n)} catch (r) { } })} function SelectAll() {CheckAll("RowCheckBox")} function UnSelectAll() {UnCheckAll("RowCheckBox")} function CountTotalPage(e, n) {var o = 0; return n <= e ? o = 1 : (o = Math.floor(n / e), n % e > 0 && (o += 1)), o} function CreateDialog(e, n) {return $(e).dialog({modal: !0, dialogClass: void 0 === n ? "" : n})} function PopupAlertWindow(e, n, o, a, l) {void 0 === l && (l = !0), void 0 === o && (o = "undefined" != typeof PageParameterObject && PageParameterObject.hasOwnProperty("IsMobile") && PageParameterObject.IsMobile ? 320 : 500), void 0 === a && (a = 200), PopupDialogWindow("PopupAlertWindow", e, !0, l, !1, o, a, n = "<div class='AlertMsgDIVNew Bold'>" + n + "</div>"); try {BackToTop()} catch (r) { } } function PopupToastMessage(e, n, o) {try {("warning" == e || "danger" == e) && (e = "info"), void 0 === o && (o = 1500); var a = $("#PopupShowTipDIV"); DomHasElement("PopupShowTipDIV") || (a = $('<span id="PopupShowTipDIV"></span>'), $(document.body).append(a)), a.stop(!0).prop("class", "alert-" + e).html(n).css("margin-left", -a.outerWidth() / 2).fadeIn(500).delay(o).fadeOut(500)} catch (l) { } } function PopupConfirmWindow(title, content, ConfirmCallBack, CancelCallBack, CallBackObject, width, height) {PopupConfirmWindowParameters = {ConfirmCallBack: ConfirmCallBack, CancelCallBack: CancelCallBack, CallBackObject: CallBackObject}; var ControlButtonHTML = "<div class='MarginTop10'><input type='button' value='确定' class='Button' onclick=\"PopupConfirmWindowOK()\" />&nbsp;<input type='button' value='取消' class='Button' onclick=\"PopupConfirmWindowCANCEL()\" /></div>"; void 0 === width && (width = 500), void 0 === height && (height = 200), PopupDialogWindow("PopupConfirmWindow", title, !0, !0, !0, width, height, content, "", [{text: "确定", click: function () {try {PopupConfirmWindowParameters.ConfirmCallBack.length > 0 && eval(PopupConfirmWindowParameters.ConfirmCallBack + "(PopupConfirmWindowParameters.CallBackObject)")} catch (e) { } PopupDialogWindow.close("PopupConfirmWindow")}}, {text: "取消", click: function () {try {PopupConfirmWindowParameters.CancelCallBack.length > 0 && eval(PopupConfirmWindowParameters.CancelCallBack + "(PopupConfirmWindowParameters.CallBackObject)")} catch (e) { } PopupDialogWindow.close("PopupConfirmWindow")}}])} function PopupSuccessWindow(e, n, o, a, l, r) {void 0 === o && (o = 500), void 0 === a && (a = 200), n = '<div class="ProcessSuccessMsgDIV30" style="font-size:12px;">' + n + "</div>"; var s = !1; (void 0 === r || r) && 0 >= n.indexOf("<input") && (s = !0), PopupDialogModelWindow(), Element.SetHtml($("#exampleNiftyNewspaperPopupContainer .V5PopupTitleDIV"), e), Element.SetHtml($("#exampleNiftyNewspaperPopupContainer .V5PopupContentDIV"), n + "<div id='ControlButtonDIV' class='Padding10 Right'></div>"), void 0 !== l && l ? window.setTimeout(function () {ClosePopupDialogModelWindow()}, 1500) : (void 0 === r || r) && 0 >= n.indexOf("<input") && (document.getElementById("ControlButtonDIV").innerHTML = '<button type="button" class="btn btn-primary" onclick="ClosePopupDialogModelWindow()">确定</button>')} function PopupInfoWindow(e, n, o, a) {void 0 === o && (o = 500), void 0 === a && (a = 200), PopupDialogWindow("PopupInfoWindow", e, !0, !0, !1, o, a, n = '<div class="InfoMsgDIV30">' + n + "</div>", "", [{text: "关闭", click: function () {PopupDialogWindow.close("PopupInfoWindow")}}])} DomReady(function () {var e; window.location.host.toLowerCase()}); var PopupRemindWindow = {WindowID: "PopupRemindWindowDIV", IsOpen: !1, GetWindowObject: function () {return $("#" + this.WindowID)}, Open: function (e, n, o, a) {this.IsOpen && this.Close(), $('<div id="PopupRemindWindowDIV">' + n + "</div>").dialog({width: o, height: a, title: e, dialogClass: "PopupRemindWindow", show: {effect: "slide", duration: 500, direction: "down"}, position: {my: "left top", at: "right bottom"}}), this.IsOpen = !0}, Close: function () {this.GetWindowObject().dialog("destroy")}}; function LoadJSCSSFile(e, n) {if ("js" == n) {var o = document.createElement("script"); o.setAttribute("type", "text/javascript"), o.setAttribute("src", e), o.setAttribute("charset", "utf-8")} else if ("css" == n) {var o = document.createElement("link"); o.setAttribute("rel", "stylesheet"), o.setAttribute("type", "text/css"), o.setAttribute("href", e)} void 0 !== o && document.getElementsByTagName("head")[0].appendChild(o)} function LoadJSCSSFileIframe(e, n, o) {var a = GetIframeWindow(e); if ("js" == o) {var l = a.document.createElement("script"); l.setAttribute("type", "text/javascript"), l.setAttribute("src", n), l.setAttribute("charset", "utf-8")} else if ("css" == o) {var l = a.document.createElement("link"); l.setAttribute("rel", "stylesheet"), l.setAttribute("type", "text/css"), l.setAttribute("href", n)} void 0 !== l && a.document.getElementsByTagName("head")[0].appendChild(l)} function LoadWorkFlowInterfaceScript() {AjaxLoadScript("script/WorkFlowInterface.js?Version=2016030")} function LoadFileUploadScript(e) {void 0 === e && (e = ""), !DomHasElement("FileUploadIframe") && ($(document.body).append("<iframe name='FileUploadIframe' id='FileUploadIframe' frameborder='no' height='0' width='0' marginheight='0' marginwidth='0'></iframe>"), AjaxLoadScript("script/FileUploadInterface.js?Version=20160201", e, ""))} function LoadScriptAttributeList(e) {PageDynamicObject.PendingLoadScriptAttributeList = e, CheckLoadScriptAttributeList()} function CheckLoadScriptAttributeList() {0 == PageDynamicObject.PendingLoadScriptAttributeList.length ? PageDynamicObject.LoadScriptAttributeListCallBack() : AjaxLoadScript(PageDynamicObject.PendingLoadScriptAttributeList.shift(), "CheckLoadScriptAttributeList", "(function(){PopupAlertWindow('加载失败','加载Script失败！')})")} function LoadSocketScript() {AjaxLoadScript("script/Socket.js")} function LoadLodopPrinter(e) {AjaxLoadScript("script/LodopFuncs.js", e)} function AjaxLoadScript(e, n, o) {AjaxLoader(!1, e + "?Version=" + Math.random(), "", "", null, n, o, null, "script", !0)} var AjaxResultObjectDictionary = {}, AjaxRequestQueue = []; function AjaxLoader(NeedUpdateShowMsgDIVID, ActionURL, ShowMsgDIVID, LoadingMsg, AjaxPostDataObject, SuccessCallBack, ErrorCallBack, CallBackObject, DataType, Cache, ActionType) {var AjaxLoaderUniqueKey = NewGuid(); if (void 0 === SuccessCallBack && (SuccessCallBack = ""), void 0 === ErrorCallBack && (ErrorCallBack = ""), (void 0 === NeedUpdateShowMsgDIVID || null == NeedUpdateShowMsgDIVID) && (NeedUpdateShowMsgDIVID = !0), NeedUpdateShowMsgDIVID && LoadingMsg.length > 0 && (document.getElementById(ShowMsgDIVID).innerHTML = LoadingMsg), void 0 === ActionType && (ActionType = "script" == DataType ? "GET" : "POST"), void 0 === Cache && (Cache = !1), "script" == (DataType = void 0 !== DataType ? DataType : "json")) {if (null == LoadedScriptURLArray) LoadedScriptURLArray = []; else if (Array.contains(LoadedScriptURLArray, ActionURL)) {"function" == typeof SuccessCallBack ? SuccessCallBack.call(this, {}) : SuccessCallBack.length > 0 && eval(SuccessCallBack + (/\)$/.test(SuccessCallBack) ? "" : "(AjaxResultObject)")); return } } var request = $.ajax({url: ActionURL, cache: Cache, type: ActionType, data: AjaxPostDataObject, dataType: DataType, timeout: 1e6, error: function (e, n, o) {Array.remove(AjaxRequestQueue, request), HideLoadingStatusDIV(); var a = "abort" == n, l = e.hasOwnProperty("responseText") ? e.responseText : ""; NeedUpdateShowMsgDIVID ? document.getElementById(ShowMsgDIVID).innerHTML = AlertImg + "<font color='red'>对不起，加载失败,ErrorCode：" + n + "，Description：" + o + "。</font>" + l : a || null != CallBackObject && CallBackObject.hasOwnProperty("AjaxLoaderHideErrorMsg") && CallBackObject.AjaxLoaderHideErrorMsg}, success: function (response) {if (AjaxResultObject = response, AjaxResultObjectDictionary[AjaxLoaderUniqueKey] = response, Array.remove(AjaxRequestQueue, request), "json" == DataType || "jsonp" == DataType) {if (void 0 !== CallBackObject && null != CallBackObject && (AjaxResultObject = Object.merge(AjaxResultObject, CallBackObject), AjaxResultObjectDictionary[AjaxLoaderUniqueKey] = Object.merge(AjaxResultObjectDictionary[AjaxLoaderUniqueKey], CallBackObject)), AjaxResultObjectDictionary[AjaxLoaderUniqueKey].IsSuccess ? (NeedUpdateShowMsgDIVID && (document.getElementById(ShowMsgDIVID).innerHTML = AjaxResultObjectDictionary[AjaxLoaderUniqueKey].Result), "function" == typeof SuccessCallBack ? SuccessCallBack.call(this, AjaxResultObjectDictionary[AjaxLoaderUniqueKey]) : null == SuccessCallBack || SuccessCallBack.length > 0 && eval(SuccessCallBack + "(AjaxResultObjectDictionary['" + AjaxLoaderUniqueKey + "'])")) : (NeedUpdateShowMsgDIVID && (document.getElementById(ShowMsgDIVID).innerHTML = AlertImg + "<font color='red'>对不起，加载失败,原因：" + AjaxResultObjectDictionary[AjaxLoaderUniqueKey].ErrorMsg + "。</font>"), "function" == typeof ErrorCallBack ? ErrorCallBack.call(this, AjaxResultObjectDictionary[AjaxLoaderUniqueKey]) : null == ErrorCallBack || ErrorCallBack.length > 0 && eval(ErrorCallBack + "(AjaxResultObjectDictionary['" + AjaxLoaderUniqueKey + "'])")), AjaxResultObjectDictionary[AjaxLoaderUniqueKey].hasOwnProperty("Script") && null != AjaxResultObjectDictionary[AjaxLoaderUniqueKey].Script && AjaxResultObjectDictionary[AjaxLoaderUniqueKey].Script.length > 0) try {0 != AjaxResultObjectDictionary[AjaxLoaderUniqueKey].Script.indexOf("{") && eval(AjaxResultObjectDictionary[AjaxLoaderUniqueKey].Script)} catch (e) {PopupAlertWindow("异步回调失败", "执行异步回调失败，原因：" + e.message)} } else Array.include(LoadedScriptURLArray, ActionURL), "function" == typeof SuccessCallBack ? SuccessCallBack.call(this, AjaxResultObjectDictionary[AjaxLoaderUniqueKey]) : null == SuccessCallBack || SuccessCallBack.length > 0 && eval(SuccessCallBack + (/\)$/.test(SuccessCallBack) ? "" : "(AjaxResultObjectDictionary['" + AjaxLoaderUniqueKey + "'])"))}}); return Array.include(AjaxRequestQueue, request), request} function ExecuteAjaxResultObject(AjaxResultObject, ShowMsgDIVID) {var NeedUpdateShowMsgDIVID = !0; AjaxResultObject.IsSuccess ? NeedUpdateShowMsgDIVID && (document.getElementById(ShowMsgDIVID).innerHTML = AjaxResultObject.Result) : NeedUpdateShowMsgDIVID && (document.getElementById(ShowMsgDIVID).innerHTML = AlertImg + "<font color='red'>对不起，加载失败,原因：" + AjaxResultObject.ErrorMsg + "。</font>"), null != AjaxResultObject.Script && AjaxResultObject.Script.length > 0 && eval(AjaxResultObject.Script)} function AbortAllAjaxRequest() {AjaxRequestQueue.length > 0 && (AjaxRequestQueue.each(function (e, n) {try {void 0 !== e && e.abort()} catch (o) { } }), AjaxRequestQueue = [])} function ShowOverlayMsg(e, n, o) {jQuery('<div id="Overlay"><div class="DisplayContentInOverlay">' + e + "</div></div>").appendTo(document.body), n && window.setTimeout(function () {CloseOverlayMsg()}, o)} function CloseOverlayMsg() {Element.Remove("Overlay")} function ShowLoadingStatusDIV(e, n, o) {void 0 === e && (e = null), void 0 === n && (n = "正在加载..."), void 0 === o && (o = !0); var a = $(".loading-indicator"); a.length > 0 ? a.html(n) : (void 0 !== e && null != e && 0 != e.length && DomHasElement(e) || (e = DomHasElement("PageMainContentLayoutDIV") ? "#PageMainContentLayoutDIV" : "body"), ShowLoadingOverlayedDIVID = e, ShowLoadingStatusDIVDO(e, n, o))} function ShowLoadingStatusDIVDO(e, n, o) {$(e).showLoading({content: n})} function HideLoadingStatusDIV() {$(ShowLoadingOverlayedDIVID).hideLoading()} var ToolbarButtonIndex = 0, PopupDialogWindowObjectMapping = {}, PopupDialogWindowTopValue = 0, PopupDialogWindowCloseCallBack = {}; function PopupDialogWindow(id, title, modal, closable, collapseable, width, height, content, closeAction, ToolBarButtonSettingObjectArray, TitleClassName, ContentClassName, CloseCallBack, ToolbarShowCheckAllCheckBox, ToolbarCheckBoxCSSClass, ToolbarAdditionalText, ToolBarHTML, InnerPaddingWidth) {PopupDialogWindowCloseCallBack[id] = CloseCallBack, void 0 === InnerPaddingWidth && (InnerPaddingWidth = 10), PopupDialogWindowTopValue = $(document).scrollTop(); try {BackToTop()} catch (e) { } void 0 === closeAction && (closeAction = "destroy"), (void 0 === id || 0 == id.length) && (id = "PopupDialogWindowContainerDIV"), PopupDialogWindowID = id; try {PopupDialogWindow.close(id)} catch (e) { } var HasToolbarButton = !1, NeedBlindEventForToolbarButton = !1, ToolbarButtonHTML = "", ToolbarButtonEventObject = null; if (void 0 === ToolBarButtonSettingObjectArray || null == ToolBarButtonSettingObjectArray || "" == ToolBarButtonSettingObjectArray || (void 0 !== ToolbarShowCheckAllCheckBox && ToolbarShowCheckAllCheckBox && (ToolbarButtonHTML += GetCheckAllObject(ToolbarCheckBoxCSSClass)), ToolbarButtonEventObject = {}, ToolBarButtonSettingObjectArray.foreach(function (e, n) {var o = id + "-" + ++ToolbarButtonIndex; ToolbarButtonHTML += "<input type='button' value=\"" + e.text + '" id="' + o + '" ' + (e.hasOwnProperty("classname") ? 'class="' + e.classname + '"' : "") + " />", ToolbarButtonEventObject[o] = e.click}), void 0 !== ToolbarAdditionalText && ToolbarAdditionalText.length > 0 && (ToolbarButtonHTML += ToolbarAdditionalText), ToolbarButtonHTML.length > 0 && (ToolbarButtonHTML = "<div class='PopupDialogWindowToolbar' style='width:" + (width - InnerPaddingWidth) + "px'>" + ToolbarButtonHTML + "</div>", HasToolbarButton = !0, NeedBlindEventForToolbarButton = !0)), void 0 === ToolBarHTML || null == ToolBarHTML || "" == ToolBarHTML || (HasToolbarButton = !0, ToolbarButtonHTML = "<div class='PopupDialogWindowToolbar' style='width:" + (width - InnerPaddingWidth) + "px'>" + ToolBarHTML + "</div>"), HasToolbarButton && (content = '<div id="' + PopupDialogWindowID + 'InnerContent" style="width:' + (width - InnerPaddingWidth) + "px; height:" + (height - 150) + "px;\" class='OverFlowAuto'>" + content + "</div>"), $('<div id="' + PopupDialogWindowID + '" rel="{width:' + width + ",height:" + height + "}\"><div class='Bold " + (void 0 === TitleClassName ? "" : TitleClassName) + "'>" + title + '</div><div class="' + (void 0 === ContentClassName ? "" : ContentClassName) + (HasToolbarButton ? " Relative HideOverFlow" : "") + '" ' + (HasToolbarButton ? " style='padding-bottom:50px;'" : "") + ">" + content + ToolbarButtonHTML + "</div></div>").jqxWindow({keyboardCloseKey: closable ? "esc" : "", isModal: modal, width: width, height: height, showCloseButton: closable, showCollapseButton: collapseable, resizable: !1, theme: "arctic", autoOpen: !1}), NeedBlindEventForToolbarButton) for (var ButtonID in ToolbarButtonEventObject) BlindEvent($("#" + ButtonID), {click: ToolbarButtonEventObject[ButtonID]}); if (HasToolbarButton) {var ToolBarHeight = Element.Size($("#" + PopupDialogWindowID + " .PopupDialogWindowToolbar")).height; Element.SetStyle($("#" + PopupDialogWindowID + "InnerContent"), "height", height - ToolBarHeight - 80)} void 0 !== CloseCallBack && CloseCallBack.length > 0 && $("#" + PopupDialogWindowID).on("close", function (event) {"function" == typeof CloseCallBack ? CloseCallBack.call(this) : eval(CloseCallBack + "();"), "destroy" == closeAction && PopupDialogWindow.close(PopupDialogWindowID)}), $("#" + PopupDialogWindowID).jqxWindow("open")} function ClosePopupDialogWindow(e) {void 0 === e && (e = "PopupDialogWindowContainerDIV"), PopupDialogWindow.close(e)} function PopupDialogModelWindow(e) {if (DomHasElement("exampleNiftyNewspaperPopupContainer")) void 0 === e && (e = 600), Element.SetStyle($("#exampleNiftyNewspaperPopup .modal-dialog"), "max-width", e + "px"); else {var n = ""; n += "", n += "<div id='exampleNiftyNewspaperPopupContainer'>", n += '<div class="modal fade" id="exampleNiftyNewspaperPopup" aria-hidden="true" aria-labelledby="exampleModalTitle" role="dialog" tabindex="-1" style=\'padding-top:100px;\'>', n += '<div class="modal-dialog modal-simple" ' + (void 0 === e ? "" : "style='max-width:" + e + "px !important;'") + ">", n += '<div class="modal-content">', n += '<div class="modal-header">', n += '<button type="button" class="close" data-dismiss="modal" aria-label="Close">', n += '<span aria-hidden="true">\xd7</span>', n += "</button>", n += '<h4 class="modal-title V5PopupTitleDIV"></h4>', n += "</div>", n += '<div class="modal-body V5PopupContentDIV"></div>', n += "</div>", n += "</div>", n += "</div>", n += '<button class="btn btn-info Hidden" id=\'exampleNiftyNewspaperPopupButton\' data-target="#exampleNiftyNewspaperPopup" data-toggle="modal" type="button" onclick="">自动生成</button>', n += "</div>", Element.AppendByElement($(document.body), n)} Element.HasClass($("#exampleNiftyNewspaperPopup"), "show") || $("#exampleNiftyNewspaperPopupButton").click(), Element.SetHtml($("#exampleNiftyNewspaperPopupContainer .V5PopupTitleDIV"), ""), Element.SetHtml($("#exampleNiftyNewspaperPopupContainer .V5PopupContentDIV"), "")} function PopupDialogModelWindowSetTitle(e) {Element.SetHtml($("#exampleNiftyNewspaperPopupContainer .V5PopupTitleDIV"), e)} function PopupDialogModelWindowSetContent(e) {Element.SetHtml($("#exampleNiftyNewspaperPopupContainer .V5PopupContentDIV"), e)} function ClosePopupDialogModelWindow() {$("#exampleNiftyNewspaperPopupContainer .close").click()} function BlindTips(BlindElementID, id, title, modal, closable, width, height, content, closeAction, position, showarrow, solo, event, classename, OnShowCallBack, OnHideCallBack, OnVisibleCallBack, OnBlurCallBack) {var qtipobj; return DomHasElement("qtip-" + id) && Element.Remove("qtip-" + id), void 0 === event && (event = "click"), void 0 === OnShowCallBack && (OnShowCallBack = null), void 0 === OnHideCallBack && (OnHideCallBack = null), void 0 === OnVisibleCallBack && (OnVisibleCallBack = null), void 0 === OnBlurCallBack && (OnBlurCallBack = null), ("object" == typeof BlindElementID ? BlindElementID : $("#" + BlindElementID)).qtip({id: id, content: {title: title, text: "<div style='width:" + width + "px; height:" + height + "px;' class='TipsContentDIV'>" + content + "</div>", button: closable}, show: {event: event, solo: solo, modal: modal}, hide: {event: "click" != event && "unfocus"}, position: position, style: {classes: void 0 === classename || "" == classename ? "qtip-rounded qtip-light" : classename, tip: showarrow ? {corner: !0, mimic: !1, width: 10, height: 10, border: !0, offset: 0} : {corner: !0, mimic: !1, width: 1, height: 1, border: !0, offset: -5}}, events: {hide: function () {null != OnHideCallBack && eval(OnHideCallBack), "destroy" == closeAction && this.qtip("destroy", !0)}, render: null, move: null, show: OnShowCallBack, toggle: null, visible: OnVisibleCallBack, focus: null, blur: OnBlurCallBack}})} function BlindAddNewTips(e, n) {BlindTips(n, n + "Tips", e, !1, !0, 170, null, "<div class='Padding10'>" + PageDynamicObject[n] + "</div>", "", {my: "top center", at: "bottom center", target: $("#" + n)}, !0, !0, "click", "qtip-rounded qtip-default", null, null)} function CloseTips(e) {$("#" + e).qtip("api").hide()} function CloseAllTips() {$(".qtip-close").fireEvent("click")} function ShowTips(e) {$("#" + e).qtip("api").show()} function RemoveTips(e) {$("#" + e).qtip("destroy")} function RepositionTips(e) {$("#" + e).qtip("reposition")} function RepositionTipsNew() {try {$(window).trigger("scroll")} catch (e) { } } function SetTipsContent(e, n, o) {var a = o.match(/id=['|"].*?['|"]/ig); if (null != a && a.length > 0) for (var l = 0; l < a.length; l++)try {var r = a[l].split("=")[1].replace(/['|"]/ig, ""); DomHasElement(r) && Element.Remove(r)} catch (s) { } var c = $("#" + e).qtip("api"); c.set("content.title", n), c.set("content.text", o)} PopupDialogWindow.FixContentHeight = function (ID) {var Config = eval("(" + Element.GetAttribute($("#" + ID), "rel") + ")"); void 0 === ID && (ID = "PopupDialogWindowContainerDIV"); var ToolBarHeight = Element.Size($("#" + ID + " .PopupDialogWindowToolbar")).height; Element.SetStyle($("#" + ID + "InnerContent"), "height", Config.height - ToolBarHeight - 45)}, PopupDialogWindow.show = function (e) {void 0 === e && (e = "PopupDialogWindowContainerDIV"), DomHasElement(e) && $("#" + e).jqxWindow("open")}, PopupDialogWindow.hide = function (e) {void 0 === e && (e = "PopupDialogWindowContainerDIV"), DomHasElement(e) && $("#" + e).jqxWindow("close")}, PopupDialogWindow.close = function (ID) {void 0 === ID && (ID = "PopupDialogWindowContainerDIV"), DomHasElement(ID) && ($("#" + ID).jqxWindow("destroy"), window.scrollTo(0, PopupDialogWindowTopValue), PopupDialogWindowCloseCallBack.hasOwnProperty(ID) && ("function" == typeof PopupDialogWindowCloseCallBack[ID] ? PopupDialogWindowCloseCallBack[ID].call(this) : eval(PopupDialogWindowCloseCallBack[ID])))}, PopupDialogWindow.UpdateToolBar = function (e, n) {void 0 === e && (e = "PopupDialogWindowContainerDIV"); var o = $("#" + e + " .PopupDialogWindowToolbar"); if (o.length > 0) UpdateDivContent(o, n), PopupDialogWindow.FixContentHeight(e); else if (DomHasElement(e + "DIVToolBarDIV")) {var o = $("#" + e + "DIVToolBarDIV"); if (Element.SetHtml(o, n), DomHasElement("SubmitButton")) {var a = Element.GetAttribute($("#SubmitButton"), "onclick"), l = Element.GetText($("#SubmitButton")); Element.SetHtml(o, '<div class=\'Padding10\' style=\'margin-top:10px;\'><button type="button" class="btn btn-primary" onclick="' + a + "\" style='margin-right:5px;'>" + l + '</button><button type="button" class="btn btn-outline btn-default" onclick=\'ClosePopupDialogModelWindow()\'>取消</button></div>')} } }; var RegexClass = {RemoveAllSpace: function (e) {var n = /(\r|\n|\r\r\n|\s)/ig; return e = e.replace(n, ""), n = /&nbsp;/ig, e = e.replace(n, ""), n = /\s/ig, e = e.replace(n, "")}, ReplaceAllNewLine: function (e) {var n = /(\r|\n|\r\r\n|\s)/ig; return e.replace(n, "<br />")}, RemoveAllSpaceNew: function (e) {var n = /(\r|\n|\r\r\n|\s)/ig; return e = e.replace(n, ""), n = /&nbsp;/ig, e = e.replace(n, ""), n = /\s/ig, e = e.replace(n, ""), n = /\"/ig, e = e.replace(n, "")}, CombineAllCode: function (e) {var n = /(\r|\n|\r\r\n)/ig; return e = e.replace(n, ""), n = /&nbsp;/ig, e = e.replace(n, "")}, RemoveHTMLTag: function (e) {var n = /<.*?>/ig; return e = e.replace(n, "")}, RemoveUnCharacter: function (e) {return e.replace(/[^a-z0-9]+/ig, "")}, RemoveSpecialTag: function (SpecialStr, str) {var MyRegExp = eval("/" + SpecialStr + "/ig"); return str = str.replace(MyRegExp, ""), MyRegExp = /\s/ig, str = str.replace(MyRegExp, "")}, GetRegExpValue: function (e, n) {var o = "", a = n.match(e); return null != a && (o = a[0]), o}, GetRegExpValueLast: function (e, n) {var o = "", a = n.match(e); return null != a && (o = a[a.length - 1]), o}, GetNumberValuefunction: function (e) {var n = "", o = /\d+/ig, a = e.match(o); return null != a && (n = a[0]), n}, RemoveSpecialCharacter: function (e) {return null == e ? "" : e.replace(/[^\a-\z\A-\Z0-9\u4E00-\u9FA5\-]/g, "")}, RemoveSQLSpace: function (e) {document.getElementById(e).value = document.getElementById(e).value.replace(/(\r|\n|\r\r\n|\s)/ig, " ")}, RestoreSQLSpace: function (e) {document.getElementById(e).value = document.getElementById(e).value.replace(/\s/ig, "\r\n")}, ParseFieldValue: function (e, n) {var o = "", a = RegexClass.GetRegExpValue(e, n); return a.length > 0 && (o = (a = RegexClass.GetRegExpValue(/value=".*?"/ig, a)).replace(/"/ig, "").replace(/value=/ig, "")), o}}; function Interface_SubmitForm_Success(e) {HideLoadingStatusDIV(), PopupToastMessage("info", (e.hasOwnProperty("ActionName") ? e.ActionName : "提交") + "成功")} function Interface_SubmitForm_Success_JSON(AjaxResultObjectJSON) {var AjaxResultObject = eval("(" + AjaxResultObjectJSON + ")"); Interface_SubmitForm_Success(AjaxResultObject)} function Interface_SubmitForm_Error(e) {HideLoadingStatusDIV(), PopupToastMessage("info", e.ErrorMsg)} function GetLoadServiceLink(e) {return "Ajax/Task/LoadService.aspx?IsMenu=false&TaskName=&TaskGuid=&WCFUITaskGuid=" + e + "&FormEvent=0&SubmitFormEventDealer=&Version=" + Math.random()} function LoadService(e, n, o, a, l, r, s, c, d) {LoadServiceInterface({IsMenu: PageParameterObject.IsMenu, TaskName: PageParameterObject.TaskName, TaskGuid: PageParameterObject.TaskGuid, WCFUITaskGuid: PageParameterObject.WCFUITaskGuid, FormEvent: c, SubmitFormEventDealer: d}, e, n, o, a, l, r, s, c, d)} function LoadServiceFailed(e) {document.getElementById("PageMainContentContainerDIV").innerHTML = GetErrorMsgHTML("调用WCF服务失败，原因：" + e.ErrorMsg)} function LoadServiceInterface(e, n, o, a, l, r, s, c, d, u) {var p; return PageParameterObject.IsMobile && null != l && !l.hasOwnProperty("MobileUserToken") && PageDynamicObject.hasOwnProperty("MobileUserToken") && PageDynamicObject.MobileUserToken.length > 0 && (l.MobileUserToken = PageDynamicObject.MobileUserToken), AjaxLoader(n, "Ajax/Task/LoadService.aspx?IsMenu=" + e.IsMenu + "&TaskName=" + encodeURIComponent(e.TaskName) + "&TaskGuid=" + encodeURIComponent(e.TaskGuid) + "&WCFUITaskGuid=" + encodeURIComponent(e.WCFUITaskGuid) + "&FormEvent=" + encodeURIComponent(e.FormEvent) + "&SubmitFormEventDealer=" + encodeURIComponent(e.SubmitFormEventDealer) + (PageParameterObject.hasOwnProperty("IsMobile") && PageParameterObject.IsMobile && PageParameterObject.RequestQueryDictionary.hasOwnProperty("Token") ? "&Token=" + PageParameterObject.RequestQueryDictionary.Token : "") + "&Version=" + Math.random(), o, a, l, r, s, c)} function LoadServiceInterfaceNoLogin(e, n, o, a, l, r, s, c, d, u) {var p; return PageParameterObject.IsMobile && null != l && !l.hasOwnProperty("MobileUserToken") && PageDynamicObject.hasOwnProperty("MobileUserToken") && PageDynamicObject.MobileUserToken.length > 0 && (l.MobileUserToken = PageDynamicObject.MobileUserToken), AjaxLoader(n, "Ajax/Task/LoadServiceNoLogin.aspx?IsMenu=" + e.IsMenu + "&TaskName=" + encodeURIComponent(e.TaskName) + "&TaskGuid=" + encodeURIComponent(e.TaskGuid) + "&WCFUITaskGuid=" + encodeURIComponent(e.WCFUITaskGuid) + "&FormEvent=" + encodeURIComponent(e.FormEvent) + "&SubmitFormEventDealer=" + encodeURIComponent(e.SubmitFormEventDealer) + "&Version=" + Math.random(), o, a, l, r, s, c)} function LoadMenuServiceInterface(e, n, o, a, l, r, s, c, d, u) {var p; AjaxLoader(n, "Ajax/Task/LoadMenu.aspx?IsMenu=true&TaskName=" + encodeURIComponent(e.TaskName) + "&TaskGuid=" + encodeURIComponent(e.TaskGuid) + "&WCFUITaskGuid=" + encodeURIComponent(e.WCFUITaskGuid) + "&FormEvent=" + encodeURIComponent(e.FormEvent) + "&SubmitFormEventDealer=" + encodeURIComponent(e.SubmitFormEventDealer) + "&Version=" + Math.random(), o, a, l, r, s, c)} function LoadScript(e, n, o, a, l, r) {var s; ShowLoadingStatusDIV(null, LoaderImg + "正在加载" + n + "，请稍候..."), AjaxLoader(!1, "Ajax/Task/LoadScript.aspx?IsMenu=" + e + "&TaskName=" + encodeURIComponent(n) + "&TaskGuid=" + encodeURIComponent(o) + "&WCFUITaskGuid=" + encodeURIComponent(a) + "&Version=" + Math.random(), "", "", null, l, r, null, "script")} function ExportExcelByHTML(e, n, o) {if (!DomHasElement(e)) {alert("对不起，没有找到您要导出的数据表！"); return } var a = document.getElementById(e).innerHTML; void 0 === o && (o = ""), IsClientMode ? WinFormClass.ExportExcelByHTML(a, n, o) : (document.getElementById("ExcelDataTableContent").value = encodeURIComponent(a), document.getElementById("ExportExcelByHTMLForm").action = "ExportExcelByHTML.aspx?ExcelName=" + encodeURIComponent(n) + "&FileType=" + o + "&Version=" + Math.random(), document.getElementById("ExportExcelByHTMLForm").submit())} function Common_AddNewEdit_Succes(e) {try {Interface_SubmitForm_Success(e); try {IframeCreatorInfoObject.window.SetPendingRefreshGrid(!0)} catch (n) { } try {CloseIframeWindow()} catch (o) { } } catch (a) { } } function Common_AddNewEditSelfGrid_Succes(e) {try {Interface_SubmitForm_Success(e), RefreshGrid()} catch (n) { } } function Common_Delete_Succes(e) {try {var n = e.hasOwnProperty("ActionName") ? e.ActionName : ""; RefreshGrid(), HideLoadingStatusDIV(), PopupSuccessWindow("删除" + n, "删除" + n + "成功！"); try {UnCheckAll("RowCheckBox")} catch (o) { } } catch (a) { } } function Common_Success_NoUnCheckAll(e) {try {var n = e.hasOwnProperty("ActionName") ? e.ActionName : ""; HideLoadingStatusDIV(), PopupToastMessage("info", n + "成功")} catch (o) { } } function Common_Success_JSON(e) {Common_Success(JSON.decode(e))} function Common_Success(e) {try {try {UnCheckAll("RowCheckBox")} catch (n) { } var o = e.hasOwnProperty("ActionName") ? e.ActionName : ""; HideLoadingStatusDIV(), PopupToastMessage("info", o + "成功")} catch (a) { } } function Common_Success_Grid(e) {try {try {UnCheckAll("RowCheckBox")} catch (n) { } var o = e.hasOwnProperty("ActionName") ? e.ActionName : ""; HideLoadingStatusDIV(), RefreshGrid(), PopupToastMessage("info", o + "成功")} catch (a) { } } function Common_Success_Grid_ClosePopupWindow(e) {try {try {UnCheckAll("RowCheckBox")} catch (n) { } PopupDialogWindow.close(); var o = e.hasOwnProperty("ActionName") ? e.ActionName : ""; HideLoadingStatusDIV(), RefreshGrid(), PopupSuccessWindow(o, o + "成功！")} catch (a) { } } function Common_Success_Grid_PopupToastMessage(e) {try {try {UnCheckAll("RowCheckBox")} catch (n) { } var o = e.hasOwnProperty("ActionName") ? e.ActionName : ""; HideLoadingStatusDIV(), RefreshGrid(), PopupToastMessage("success", o + "成功！")} catch (a) { } } function Common_Success_Grid_HideSuccessMessage() {try {try {UnCheckAll("RowCheckBox")} catch (e) { } HideLoadingStatusDIV(), RefreshGrid()} catch (n) { } } function Common_Error(e) {try {var n = e.hasOwnProperty("ActionName") ? e.ActionName : ""; HideLoadingStatusDIV(), PopupToastMessage("info", e.hasOwnProperty("ErrorMsg") && e.ErrorMsg.length > 0 ? e.ErrorMsg : n + "失败")} catch (o) {alert(o.toString())} } function Common_Delete_Error(e) {try {UnCheckAll("RowCheckBox")} catch (n) { } var o = "删除" + (e.hasOwnProperty("ActionName") ? e.ActionName : ""); e.ActionName = o, Common_Error(e)} function CloseIframeWindowAndRefreshParentGrid() {try {IframeCreatorInfoObject.window.SetPendingRefreshGrid(!0), CloseIframeWindow()} catch (e) { } } function RefreshParentGrid() {try {IframeCreatorInfoObject.window.SetPendingRefreshGrid(!0)} catch (e) { } } function FixDataTableContainerSize(e, n, o) {try {var a = $("#" + e).width(); $("#" + n).css("width", a - 15); var l = $("#" + n).height() + 25; l > o && (l = o), $("#" + e).css("height", l)} catch (r) { } } function FixDataTableContainerWidth(e, n) {try {var o = $("#" + e).width(); $("#" + n).css("width", o - 15 + "px")} catch (a) { } } function FixWidth(e, n) {try {void 0 !== n && $("#" + e).width() > n && $("#" + e).css("width", n + "px")} catch (o) { } } function FixTable(e, n, o, a, l) {AjaxLoadScript("script/fixed_table_rc.js", function () {$("#" + e).fxdHdrCol({fixedCols: n, width: o, height: a, colModal: l})})} function FixImageWidth(e) {e.foreach(function (e, n) {var o = Element.Size($(e)), a = $("img", $(e))[0], l = PageDynamicObject.GetImageSize(a); if (l.width > 0 && l.height > 0) {var r = o.width - 10, s = o.height - 10; r > 0 && s > 0 && (l.width > r && (l.height = parseInt(parseFloat(l.height) * (parseFloat(r) / parseFloat(l.width))), l.width = r), l.height > s && (l.width = parseInt(parseFloat(l.width) * (parseFloat(s) / parseFloat(l.height))), l.height = s), Element.SetStyle($(a), "width", l.width + "px"), Element.SetStyle($(a), "height", l.height + "px"))} })} function FixImageWidthBySize(e, n, o) {e.foreach(function (e, a) {var l = $("img", $(e))[0], r = PageDynamicObject.GetImageSize(l); r.width > 0 && r.height > 0 && n > 0 && o > 0 && (r.width > n && (r.height = parseInt(parseFloat(r.height) * (parseFloat(n) / parseFloat(r.width))), r.width = n), r.height > o && (r.width = parseInt(parseFloat(r.width) * (parseFloat(o) / parseFloat(r.height))), r.height = o), Element.SetStyle($(l), "width", r.width + "px"), Element.SetStyle($(l), "height", r.height + "px"))})} function GetImageSize(e) {var n = {}; if (void 0 === e.naturalWidth) {var o = new Image; o.src = e.src, n.width = o.width, n.height = o.height} else n.width = e.naturalWidth, n.height = e.naturalHeight; return n} function OutputDataTableDOByList(e, n, o, a, l, r, s, c, d) {if (0 == e.length) return ""; var u = 0 == s.length ? "" : " width='" + s + "' "; n > e.length && (n = e.length); for (var p = 0, m = "<table cellspacing='1' cellpadding='0' border='0' bgcolor='" + r + "' " + u + " class='" + o + "' id='" + c + "' " + (d ? 'align="center"' : "") + ">", g = 0; g < e.length; g++) {0 == p && (m += "<tr>"); var f = g == e.length - 1, h = f ? n - p : 1; m += '<td class="' + l + "\" valign='top' " + ((h = 1) > 1 ? "colspan='" + h + "'" : "") + ">" + e[g] + "</td>", p++, (f || p == n) && (m += "</tr>", p = 0)} return m + "</table>"} function GetAgencyIDDepartmentIDSelectObjectHTML(e, n, o, a, l, r, s, c, d, u) {LoadServiceClass.LoadServiceInterface("加载组织部门", "CustomizedWCFUI.ServiceFactory.Public.PublicClass", "GetAgencyIDDepartmentIDSelectObjectHTML", !0, e, GetLoadingMsg("正在加载数据表..."), {AgencyObjectID: n, DepartmentObjectID: o, AgencyID: a, DepartmentID: l, PermissionMenuCode: r, IsRestrictMode: s, IsMetroStyle: c}, d, u, {ActionName: "加载组织部门"})} function OutputDataTableDoBySql(e, n, o, a, l, r, s, c, d, u, p, m, g, f, h, v, C, y, b, S, I, D, w, T, x, P, L) {var A = "", M = []; L.foreach(function (e, n) {Array.include(M, JSON.encode(e))}), A = "[" + M.join(",") + "]", LoadServiceClass.LoadServiceInterface("加载数据表", "CustomizedWCFUI.ServiceFactory.Public.PublicClass", "OutputDataTableDoBySql", !0, e, GetLoadingMsg("正在加载数据表..."), {ContainerDIVID: e, IsSystemFrameWork: n, sql: o, RestoreFormKey: a, RestoreDataTableName: l, CombineDataRowSettingJSON: JSON.encode(r), OutputHeader: s, TableCSSClass: c, HeaderCSSClass: d, DataCSSClass: u, TableBorderColor: p, TableWidth: m, FirstRowWidth: g, TableID: f, ColumnWidthPercent: h, SumString: v, CombineEmptyContent: C, ShowDisplayCSSClassName: y, FillNullDisplayValue: b, NotFillNullDisplayValueColumnList: S, ApplyPermissionProperty: I, ConvertColumnNameToCN: D, ColumnNameDictionaryJSON: JSON.encode(w), RemoveColumnNameList: T, HighChartsConfigList: A}, x, P, {ActionName: "加载数据表"})} function MergeDataTableCell(e, n, o, a, l) {if (DomHasElement(e)) {var r = null; if (void 0 !== l && null != l && l.length > 0 && (r = [], $("#" + e + " ." + l).foreach(function (e, n) {var o = $(e); o.is("td") || (o = $(o.parents("td")[0])); var a = Element.GetAttribute(o, "rowspan"); a = void 0 === a || null == a ? 1 : parseInt(a); for (var l = RegexClass.RemoveHTMLTag(Element.GetHtml($(e))), s = 0; s < a; s++)Array.include(r, l)})), "水平合并" == o) $("#" + e + " tr").foreach(function (e, o) {e = $(e); var l = [], s = $("." + n, e), c = 0; s.foreach(function (e, n) {if (n > 0) {var o = RegexClass.RemoveHTMLTag(Element.GetHtml($(e))); if (0 != o.length || a) {var d = RegexClass.RemoveHTMLTag(Element.GetHtml($(s[n - 1]))); if (null != r && (o += r[n], d += r[n - 1]), o == d) {if (0 == c) {var u = []; Array.include(u, $(s[n - 1]).is("td") ? $(s[n - 1]) : $($(s[n - 1]).parents("td")[0])), Array.include(u, $(s[n]).is("td") ? $(s[n]) : $($(s[n]).parents("td")[0])), Array.include(l, u)} else {var u = l.last(); Array.removeat(l, l.length - 1), Array.include(u, $(s[n]).is("td") ? $(s[n]) : $($(s[n]).parents("td")[0])), Array.include(l, u)} c++} else c = 0} else c = 0} }), l.length > 0 && l.foreach(function (e, n) {Element.SetAttribute(e[0], "colspan", e.length); for (var o = 1; o < e.length; o++)Element.RemoveByElement($(e[o]))})}); else {var s = [], c = $("#" + e + " ." + n), d = 0; c.foreach(function (e, n) {if (n > 0) {var o = RegexClass.RemoveHTMLTag(Element.GetHtml($(e))); if (0 != o.length || a) {var l = RegexClass.RemoveHTMLTag(Element.GetHtml($(c[n - 1]))); if (null != r && (o += r[n], l += r[n - 1]), o == l) {if (0 == d) {var u = []; Array.include(u, $(c[n - 1]).is("td") ? $(c[n - 1]) : $($(c[n - 1]).parents("td")[0])), Array.include(u, $(c[n]).is("td") ? $(c[n]) : $($(c[n]).parents("td")[0])), Array.include(s, u)} else {var u = s.last(); Array.removeat(s, s.length - 1), Array.include(u, $(c[n]).is("td") ? $(c[n]) : $($(c[n]).parents("td")[0])), Array.include(s, u)} d++} else d = 0} else d = 0} }), s.length > 0 && s.foreach(function (e, n) {Element.SetAttribute(e[0], "rowspan", e.length); for (var o = 1; o < e.length; o++)Element.RemoveByElement($(e[o]))})} } } function Sleep(e) {var n, o, a, l, r, s, c, d, u, p, m = new Date; n = m.getHours(), o = m.getMinutes(), a = m.getSeconds(), l = m.getMilliseconds(); do r = (p = new Date).getHours() - n, s = p.getMinutes() - o, c = p.getSeconds() - a, d = p.getMilliseconds() - l, r < 0 && (r += 24), u = 1e3 * (u = 3600 * r + 60 * s + c) + d; while (u < e)} function InsertTableRow(e, n) {return void 0 === n ? e.insertRow(0) : e.insertRow(n)} function InsertTableCell(e, n, o, a, l, r, s) {var c; return c = void 0 === n ? e.insertCell(0) : e.insertCell(n), void 0 !== o && (c.colSpan = o), void 0 !== s && (c.rowSpan = s), void 0 !== a && (c.innerHTML = a), void 0 !== l && (c.className = l), void 0 !== r && (c.style.width = r), c} function DeleteTableRow(e, n) {e.deleteRow(n)} function AddTableRow(e, n, o, a) {for (var l = InsertTableRow(e, n), r = 0; r < o.length; r++)InsertTableCell(l, r, 1, o[r], a)} function AjaxAddOptionForSelectObject(IsSystemFrameWork, KeyColumnName, ValueColumnName, Sql, TargetObjectID, ClearOptions, IsSetDefaultValue, DefaultValue, IsRestrictMode, OptionText, SuccessCallBack) {PageDynamicObject.hasOwnProperty("AjaxAddOptionForSelectObjectDictionary") || (PageDynamicObject.AjaxAddOptionForSelectObjectDictionary = {}), PageDynamicObject.AjaxAddOptionForSelectObjectDictionary[TargetObjectID] = function () {AjaxLoader(!1, "Ajax/Task/AjaxAddOptionForSelectObject.aspx?Version" + Math.random(), "", "", {IsSystemFrameWork: IsSystemFrameWork, KeyColumnName: KeyColumnName, ValueColumnName: ValueColumnName, Sql: Sql}, function (Result) {AddOptionForSelectObject(TargetObjectID, eval("(" + Result.Result + ")"), ClearOptions, IsSetDefaultValue, DefaultValue, IsRestrictMode, OptionText), "function" == typeof SuccessCallBack && SuccessCallBack.call(this); var SuccessCallBackFunctionName = TargetObjectID + "_AddOptionSuccessCallBack"; PageDynamicObject.hasOwnProperty(SuccessCallBackFunctionName) && PageDynamicObject[SuccessCallBackFunctionName].call(this)}, Common_Error, {ActionName: "AjaxAddOptionForSelectObject"})}, PageDynamicObject.AjaxAddOptionForSelectObjectDictionary[TargetObjectID]()} function AddOptionForSelectObject(e, n, o, a, l, r, s) {if (DomHasElement(e)) {var c = document.getElementById(e); o && (c.options.length = 0), r || c.options.add(new Option(s, "")); var d = "", u = 0; for (var p in n) 1 == ++u && (d = p), c.options.add(new Option(n[p], p)); AddOptionForSelectDropDown(e), void 0 !== a && a ? Element.SetValue($("#" + e), l) : r ? Element.SetValue($("#" + e), d) : Element.SetValue($("#" + e), "")} } function AddOptionForSelectMetroObject(LinkageColumnID, DictionaryJSON, ClearOptions, IsSetDefaultValue, DefaultValue, IsRestrictMode, OptionText, SuccessCallBack) {var LinkageColumnObject, e, i, FirstValue, Key, e, html, LinkageColumnContainer, AdditionalMsg, AdditionalMsgObject; AddOptionForSelectObject(LinkageColumnID, DictionaryJSON, ClearOptions, IsSetDefaultValue, DefaultValue, IsRestrictMode, OptionText), void 0 !== SuccessCallBack && SuccessCallBack.length > 0 && eval(SuccessCallBack)} function InitiateSelectDropDown(e) {try {e.selectpicker()} catch (n) { } } function AddOptionForSelectDropDown(e) {var n = $("ul.dropdown-menu", $("#" + e).parent()), o = ""; if (n.length > 0) for (var a = document.getElementById(e).options, l = a.selectedIndex, r = 0; r < a.length; r++) {a[r].value; var s = a[r].text, c = l == r; o += '<li data-original-index="' + r + '" class="' + (c ? "selected" : "") + '"><a tabindex="0" class="" data-tokens="null" role="option" aria-disabled="false" aria-selected="' + (c ? "true" : "false") + '"><span class="text">' + s + '</span><span class="glyphicon glyphicon-ok check-mark"></span></a></li>'} Element.SetHtml(n, o)} function AddQuickSearchForSelect(e) {var n = e + "QuickSearchContainerDIV", o = e + "QuickSearch"; if (!DomHasElement(n)) {var a = [], l = document.getElementById(e).options; l.selectedIndex; for (var r = 0; r < l.length; r++)l[r].value, Array.include(a, l[r].text); Element.AppendAfter(e, '<div id="' + n + "\" style='margin-top:5px; margin-bottom:5px; position:relative;'><input type='text' class='form-control' id='" + o + "' placeholder='查询关键词...'><span class='mui-icon mui-icon-closeempty HandCursor' style='position:absolute; top:5px; right:-22px;' onclick=\"Element.Remove('" + n + "')\"></span></div>"), InitiateAutoComplete(o, a, !0, function (n) {if (null != n && n.length > 0) for (var o = 0; o < l.length; o++) {var a = l[o].value; l[o].text == n && Element.SetValue($("#" + e), a)} })} } function CreateDataGrid() {PageDynamicObject.CreateDataGridDo()} function Interface_SubmitButtonClicked(TargetFormPanelID, VerifyFormCallBack, SubmitFormEventDealer, SuccessCallBack, ErrorCallBack) {if (SubmitFormSettingObject = {TargetFormPanelID: TargetFormPanelID, VerifyFormCallBack: VerifyFormCallBack, SubmitFormEventDealer: SubmitFormEventDealer, SuccessCallBack: SuccessCallBack, ErrorCallBack: ErrorCallBack}, FormPanelHashMap.hasOwnProperty(TargetFormPanelID)) {try {var Result = GetHtmlControlFormPostDataObject(TargetFormPanelID)} catch (e) {alert(e.toString())} if (Result.IsValid && (SubmitFormSettingObject.PostDataObject = Result.PostDataObject, null == VerifyFormCallBack || 0 == VerifyFormCallBack.length || eval(VerifyFormCallBack + "()"))) {if ($("#" + TargetFormPanelID + " .UploadFileListDIV").length > 0) try {Interface_StartUploadFiles(TargetFormPanelID, "Interface_SubmitForm_UploadFileCompleted")} catch (e) {alert(e.toString())} else try {Interface_SubmitForm(TargetFormPanelID, SubmitFormEventDealer, SuccessCallBack, ErrorCallBack)} catch (e) {alert(e.toString())} } } else PopupAlertWindow("提交失败", "对不起，全局FormPanelHashMap对象中没有找到" + TargetFormPanelID + "表单对象！")} function Interface_SubmitForm_UploadFileCompleted(e) {Interface_SubmitForm(SubmitFormSettingObject.TargetFormPanelID, SubmitFormSettingObject.SubmitFormEventDealer, SubmitFormSettingObject.SuccessCallBack, SubmitFormSettingObject.ErrorCallBack, e)} function Interface_SubmitForm(e, n, o, a, l) {try {ShowLoadingStatusDIV(null, "正在处理中，请稍候..."); var r = SubmitFormSettingObject.hasOwnProperty("PostDataObject") ? Object.merge({HtmlControlFormPostDataObject: SubmitFormSettingObject.PostDataObject}, l) : l; r = Object.merge(r, ExtraAjaxPostDataObject), void 0 !== r && (r.CommonChildDataTable = JSON.encode(CommonChildDataTableClass.GetPostData())), LoadService(!1, "", "", r, o, a, null, 1, n)} catch (s) {PopupAlertWindow("表单提交失败", "表单提交失败，原因：" + s.message)} } function Interface_ResetButtonClicked(TargetFormPanelID, SuccessCallBack) {try {FormPanelHashMap.hasOwnProperty(TargetFormPanelID) && ($("#" + TargetFormPanelID).find("input[type=text], textarea").val(""), void 0 !== SuccessCallBack && SuccessCallBack.length > 0 && eval(SuccessCallBack + "()"))} catch (e) { } } function Common_SubmitForm_VerifyCallBack_Success(e) {HideLoadingStatusDIV(), Interface_SubmitForm(SubmitFormSettingObject.TargetFormPanelID, SubmitFormSettingObject.SubmitFormEventDealer, SubmitFormSettingObject.SuccessCallBack, SubmitFormSettingObject.ErrorCallBack, e)} function MouseOverToogleRowColor(e, n) {try {var o = "FocusCSSTR", a = SearchElement.Children($(e), "td"); n ? Element.AddClass(a, o) : Element.RemoveClass(a, o)} catch (l) { } } function PreventDefault(e) {return e && e.preventDefault ? e.preventDefault() : window.event.returnValue = !1, !1} function InitiateCommonTab(e, n, o, a) {$("#" + e + " div").foreach(function (l, r) {BlindEvent($(l), {click: function () {var n = Element.GetAttribute($(l), "title"); void 0 === a ? OpenOrHideElementByCssName("hide", "CommonTabMainContentDIV") : OpenOrHideElementByElement("hide", $("#" + a + " .CommonTabMainContentDIV")), OpenOrHideElement("open", n + "DIV"), Element.RemoveClass($("#" + e + " div"), "Focus"), Element.AddClass($(l), "Focus"), o.call(this, n)}}), n.length > 0 && n == Element.GetAttribute($(l), "title") && $(l).fireEvent("click")})} function ToogleCommonTab(e, n) {$("#" + e + " div[title='" + n + "']").click()} function GetCOMMONYEARSelectObjectHTML(e, n, o, a) {void 0 === e && (e = "Year"), void 0 === o && (o = !0), void 0 === a && (a = ""), (void 0 === n || 0 == n.length) && (n = new Date().getFullYear()); var l = new Date().getFullYear() + 1, r = ""; r += '<select id="' + e + '" data-plugin="selectpicker" data-style="btn-outline btn-default">', o || (r += '<option value="">' + a + "</option>"); for (var s = 2010; s <= l; s++)r += '<option value="' + s + '" ' + (s == n ? "selected='selected'" : "") + ">" + s + "年</option>"; return r + "</select>"} function GetCOMMONMONTHSelectObjectHTML(e, n, o, a) {void 0 === e && (e = "Month"), void 0 === o && (o = !0), void 0 === a && (a = ""), (void 0 === n || 0 == n.length) && (n = new Date().getMonth() + 1) > 12 && (n = 1); var l = 12, r = ""; r += '<select id="' + e + '" data-plugin="selectpicker" data-style="btn-outline btn-default">', o || (r += '<option value="">' + a + "</option>"); for (var s = 1; s <= l; s++)r += '<option value="' + s + '" ' + (s == n ? "selected='selected'" : "") + ">" + PadLeft(s.toString(), 2) + "月</option>"; return r + "</select>"} function MD5Data(e, n, o) {LoadServiceClass.LoadServiceInterface("MD5加密", "CustomizedWCFUI.ServiceFactory.Public.PublicClass", "MD5Data", !1, "", "", {data: e}, n, o, {ActionName: "MD5加密"})} function 解析身份证(e) {if (18 != e.length) return {IsValid: !1}; var n = e.substring(6, 10) + "-" + e.substring(10, 12) + "-" + e.substring(12, 14), o = parseInt(e.substr(16, 1)) % 2 == 1 ? "男" : "女", a = new Date, l = a.getMonth() + 1, r = a.getDate(), s = a.getFullYear() - e.substring(6, 10) - 1; return (e.substring(10, 12) < l || e.substring(10, 12) == l && e.substring(12, 14) <= r) && s++, {IsValid: !0, 出生日期: n, 性别: o, 年龄: s}} function 解析属相(e) {return ["猴", "鸡", "狗", "猪", "鼠", "牛", "虎", "兔", "龙", "蛇", "马", "羊"][e % 12]} function 解析星座(e, n) {var o = [20, 19, 21, 21, 21, 22, 23, 23, 23, 23, 22, 22]; return "魔羯水瓶双鱼牡羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯".substr(2 * e - (n < o[e - 1] ? 2 : 0), 2) + "座"} function GenerateWorkFlowQRCode(e, n, o) {LoadServiceClass.LoadServiceInterface("生成二维码", "CustomizedWCFUI.ServiceFactory.Public.PublicClass", "GenerateWorkFlowQRCode", !1, "", "", {Content: e}, n, o, {ActionName: "生成二维码"})} function GenerateBarCode(e, n, o, a, l) {LoadServiceClass.LoadServiceInterface("生成条形码", "CustomizedWCFUI.ServiceFactory.Public.PublicClass", "GenerateBarCode", !1, "", "", {Content: o, width: e, height: n}, a, l, {ActionName: "生成二维码"})} function LoadServerFileAdminPage(e, n, o) {var a; void 0 === o && (o = !1), OpenMaximizedWindow(!1, "管理服务器文件", PageParameterObject.SystemFrameWorkBaseURL + "/ServerFileAdminPage.aspx?IsSystemFrameWork=" + e + "&RelativeFilePath=" + encodeURIComponent(n) + "&IsFullPath=" + o + "&Version=" + Math.random())} function QRPayment(CustomerID, PaymentType, ProductName, TotalAmout, OutTradeNo, OS, SuccessCallBack, ErrorCallBack, PaymentSuccessCallBack) {var PaymentConfig = {CustomerID: CustomerID, PaymentType: PaymentType, ProductName: ProductName, TotalAmout: TotalAmout, OutTradeNo: OutTradeNo, OS: OS}; LoadServiceClass.LoadServiceInterfaceByDLLSetting("Payment.dll|Payment.Pay|QRPayment", "扫码支付", !1, "", "", PaymentConfig, function (AjaxResultObject) {var dic = eval("(" + AjaxResultObject.Result + ")"), html = dic.html; if (html = "微信" == PaymentType ? PageParameterObject.SystemFrameWorkBaseURL + "/image/BarCode/" + dic.html : html.replace(/<form/ig, '<form target="_blank" '), null == SuccessCallBack) {if ("微信" == PaymentType) {var DisplayHTML = ""; DisplayHTML += "<div class='Center' style='font-size:13px;'>支付金额<span class='Red Bold'>" + TotalAmout + "</span>元，请扫描下方的二维码支付</div>", DisplayHTML += "<table class='CenterDIV' style='margin-top:20px;'>", DisplayHTML += "<tr>", DisplayHTML += "<td><div class='Center' style='margin-bottom:20px;'><img src='image/wexinpaymenticon.jpg' style='width:100px;'></div><div class='Center'><img src='" + html + "' style='padding:10px; border:1px solid #ddd; width:150px;'></div><div class='Center' style='font-size:12px; color:#aaa; margin-top:10px; line-height:22px;'>请打开手机微信扫一扫<br>扫描上方的二维码进行支付</div></td>", DisplayHTML += "<td style='width:80px;'></td>", DisplayHTML += '<td><img src="image/wexinpayment.jpg"></td>', DisplayHTML += "</tr>", PopupDialogWindow("ViewCustomerInfoPopupWindowDIV", "微信支付", !0, !0, !1, 800, 530, "<h3 class=\"panel-title Relative\" style=\"padding-left:20px; padding-top:0px; margin-top:0px; padding-bottom:5px;\">微信支付</h3><div id='WeXinPaymentContainerDIV' class='Padding20' style='padding-top:5px;'>" + (DisplayHTML += "</table>") + "</div>", "destroy")} else DomHasElement("AlipaymentFormContainerDIV") || Element.AppendByElement($(document.body), "<div id='AlipaymentFormContainerDIV' class='Hidden'></div>"), Element.SetHtml($("#AlipaymentFormContainerDIV"), html)} else SuccessCallBack(html)}, ErrorCallBack, {ActionName: "扫码支付"})} var IsLoadedWaterMarkScript = !1; function AddWaterMask(e, n, o) {var a = document.createElement("canvas"); Element.AppendByElement($(".CompanyRuleContentDIV"), a), a.width = 300, a.height = 150, a.style.display = "none"; var l = a.getContext("2d"); l.rotate(-15 * Math.PI / 180), l.font = "12px Microsoft JhengHei", l.fillStyle = o, l.textAlign = "left", l.textBaseline = "Middle", l.fillText(n, a.width / 3, a.height / 2), Element.SetStyle(e, "background-image", "url(" + a.toDataURL("image/png") + ")"), AjaxLoadScript("script/jquery.watermark.min.js", function () {$("img", e).watermark({text: n, textWidth: 200, gravity: "se", opacity: 1, margin: 12})})} function BlindBulkEditColumnEvent(ContainerDIVID) {Element.AddClass($("#" + ContainerDIVID + " .BulkEditLink"), "BulkEditLinkDisplay"), $("#" + ContainerDIVID + " .BulkEditLink").foreach(function (element, index) {var item = $(element), BulkEditColumnSetting = eval("(" + item.attr("rel") + ")"), TipsID = item.attr("id"); BlindTips(TipsID, TipsID + "Tips", "", !1, !1, 200, null, "", "", {my: "bottom center", at: "top center", target: item}, !0, !0, "click", "qtip-rounded qtip-default", function () {CurrentBulkEditColumnSetting = BulkEditColumnSetting, CurrentTipsID = TipsID; var e = "批量修改" + BulkEditColumnSetting.ColumnNameCN + "的值", n = "<div class='MarginTop10 Center' style='padding-bottom:3px;'><input type='button' value='确定' onclick=\"BulkEditColumnDO();CloseTips('" + TipsID + "')\" class=\"CommonCancelButton\" style='padding:0px 8px !important;' />&nbsp;<input type='button' value='取消' onclick=\"CloseTips('" + TipsID + "')\" class=\"CommonCancelButton\" style='padding:0px 8px !important;' /></div>"; SetTipsContent(TipsID, e, GetBlindBulkEditColumnHTML(BulkEditColumnSetting) + n)}, null)})} function GetBlindBulkEditColumnHTML(e) {var n = ""; if (0 == e.ColumnType) n = "<div id=\"BulkEditColumnDIV\" class='Center MarginTop5'><input type='text' id='BulkEditColumnField" + e.ColumnName + "' value=\"" + e.DefaultValue + "\" autocomplete='off' /></div>"; else if (1 == e.ColumnType) {var o = [], a = ""; e.MinValue.length > 0 && (Array.include(o, "minDate:'" + e.MinValue + "'"), a += "<div class='GreyText'  style='padding-bottom:5px; text-align:left; padding-left:15px;'>允许的最小日期：" + e.MinValue + "</div>"), e.MaxValue.length > 0 && (Array.include(o, "maxDate:'" + e.MaxValue + "'"), a += "<div class='GreyText' style='padding-bottom:5px;text-align:left; padding-left:15px;'>允许的最大日期：" + e.MaxValue + "</div>"), n = "<div id=\"BulkEditColumnDIV\" class='Center'>" + a + "<input type='text' id='BulkEditColumnField" + e.ColumnName + "' class='Wdate' value=\"" + e.DefaultValue + '" onclick="WdatePicker({' + o.join(",") + "})\" autocomplete='off' /></div>"} else if (3 == e.ColumnType) {for (var l in n = "<select id='BulkEditColumnField" + e.ColumnName + "'>", e.DataSoureDictionary) n += '<option value="' + l + '" ' + (e.DefaultValue == l ? "selected='selected'" : "") + ">" + e.DataSoureDictionary[l] + "</option>"; n += "</select>", n = "<div id='BulkEditColumnDIV' class='Center'>" + n + "</div>"} else if (4 == e.ColumnType) {for (var l in e.DataSoureDictionary) n += "<div class='AlignLeft'><input type='radio' name='BulkEditColumnField" + e.ColumnName + "' value='" + l + "' " + (e.DefaultValue == l ? "checked='checked'" : "") + " />" + e.DataSoureDictionary[l] + "</div>"; n = "<div id='BulkEditColumnDIV' class='Center'>" + n + "</div>"} else if (5 == e.ColumnType || 6 == e.ColumnType) {var o = [], a = ""; e.MinValue.length > 0 && (Array.include(o, "MinValue:'" + e.MinValue + "'"), a += "<div class='GreyText'  style='padding-bottom:5px; text-align:left; padding-left:15px;'>允许的最小值：" + e.MinValue + "</div>"), e.MaxValue.length > 0 && (Array.include(o, "MaxValue:'" + e.MaxValue + "'"), a += "<div class='GreyText' style='padding-bottom:5px;text-align:left; padding-left:15px;'>允许的最大值：" + e.MaxValue + "</div>"), n = "<div id=\"BulkEditColumnDIV\" class='Center'>" + a + "<input type='text' id='BulkEditColumnField" + e.ColumnName + "' value=\"" + e.DefaultValue + '" onkeyup="CheckRangeValue(this,{' + o.join(",") + '},false)" onblur="CheckRangeValue(this,{' + o.join(",") + "},true)\" autocomplete='off' /></div>"} return n} function BulkEditColumnDO() {var value = ""; if (0 == (BulkEditColumnSetting = CurrentBulkEditColumnSetting).ColumnType || 3 == BulkEditColumnSetting.ColumnType || 1 == BulkEditColumnSetting.ColumnType) value = document.getElementById("BulkEditColumnField" + BulkEditColumnSetting.ColumnName).value; else if (4 == BulkEditColumnSetting.ColumnType) try {value = GetRadioValue("BulkEditColumnField" + BulkEditColumnSetting.ColumnName)} catch (e) { } else if (5 == BulkEditColumnSetting.ColumnType || 6 == BulkEditColumnSetting.ColumnType) try {value = document.getElementById("BulkEditColumnField" + BulkEditColumnSetting.ColumnName).value, 6 == BulkEditColumnSetting.ColumnType && value.length > 0 && (value = parseInt(value))} catch (e) { } 4 == BulkEditColumnSetting.ColumnType ? (ClearRadioSelectByCSSName(BulkEditColumnSetting.ColumnCSSClassName), SelectRadioByCSSName(BulkEditColumnSetting.ColumnCSSClassName, value)) : BulkSetValue(BulkEditColumnSetting.ColumnCSSClassName, value, !0, !0); try {$("." + BulkEditColumnSetting.ColumnCSSClassName).foreach(function (e, n) {RemoveHtmlControlErrorMsgByID(e.id)})} catch (e) { } BulkEditColumnSetting.hasOwnProperty("OnChangeJSCallBack") && BulkEditColumnSetting.OnChangeJSCallBack.length > 0 && eval(BulkEditColumnSetting.OnChangeJSCallBack + "()")} var VerifiedHtmlControlArray = []; function GetHtmlControlFormPostDataObject(TargetFormPanelID, DataRowUniqueKeyArray, ContainerElement, ShowErrorMsg) {try {CheckIsMobileV5() && (Element.RemoveByElement($(".EmptyAlertFieldMobileV5")), Element.RemoveClass($(".RightTD .PlaceHolder"), "Hidden"))} catch (e) { } void 0 === ShowErrorMsg && (ShowErrorMsg = !0), RemoveAllHtmlControlErrorMsg(TargetFormPanelID), VerifiedHtmlControlArray = [], void 0 === TargetFormPanelID && (TargetFormPanelID = ""); var IsRestrictDataRowUniqueKey = !0; (void 0 === DataRowUniqueKeyArray || null == DataRowUniqueKeyArray) && (DataRowUniqueKeyArray = [], IsRestrictDataRowUniqueKey = !1); var CSSClassName = (TargetFormPanelID.length > 0 ? "#" + TargetFormPanelID + " " : "") + ".HtmlControlField", AllHtmlControl = void 0 !== ContainerElement && null != ContainerElement ? ContainerElement.find(".HtmlControlField") : $(CSSClassName), ResultObjectArray = [], IsValid = !0, TotalError = 0, ErrorMsgList = []; AllHtmlControl.foreach(function (element, index) {var item = $(element), Config = eval("(" + item.attr("rel") + ")"); if (void 0 !== Config && (!IsRestrictDataRowUniqueKey || Array.contains(DataRowUniqueKeyArray, Config.DataRowUniqueKey))) {var Result = VerifyHtmlControl(item, Config, ShowErrorMsg); if (!1 == Result && ShowErrorMsg) {IsValid = !1; var IDArray = element.id.split("_"); Array.include(ErrorMsgList, "控件【" + (IDArray.length > 1 ? IDArray[1] : element.id) + "】验证失败。"), TotalError++} else Array.include(ResultObjectArray, Result)} }); var PostDataObject = {}; return !IsValid && ShowErrorMsg ? CheckIsMobileV5() ? NotificationClass.alert("提交失败", "对不起，表单中共有" + TotalError + "个错误。\n" + ErrorMsgList.join("\n"), "确定") : PopupToastMessage("warning", "对不起，表单中共有" + TotalError + "个错误，请修改后重新提交！" + (1 == ErrorMsgList.length ? ErrorMsgList.join("\n") : "")) : $.each(ResultObjectArray, function (e, n) {var o = PostDataObject.hasOwnProperty(n.DataRowUniqueKey) ? PostDataObject[n.DataRowUniqueKey] : {}, a = n.Value; o.hasOwnProperty(n.ColumnName) && (0 == o[n.ColumnName].length || (a = 0 == a.length ? o[n.ColumnName] : o[n.ColumnName] + "," + a)), o[n.ColumnName] = a, PostDataObject[n.DataRowUniqueKey] = o}), {IsValid: IsValid, PostDataObject: JSON.encode(PostDataObject)}} function VerifyHtmlControlByID(ObjectID) {var HtmlControlObject = $("#" + ObjectID), Config = eval("(" + HtmlControlObject.attr("rel") + ")"); !1 != VerifyHtmlControl(HtmlControlObject, Config) && RemoveHtmlControlErrorMsgByID(ObjectID)} function RemoveHtmlControlErrorMsgByID(e) {try {CheckIsMobileV5() && (Element.RemoveByElement($(".EmptyAlertFieldMobileV5")), Element.RemoveClass($(".RightTD .PlaceHolder"), "Hidden"))} catch (n) { } try {$("#" + e).removeClass("EmptyAlertField")} catch (o) { } try {var a = "." + e + "HtmlControlErrorDIV"; $(a).foreach(function (e, n) {UpdateDivContent($(e), "")})} catch (l) { } } function VerifyHtmlControl(HtmlControlObject, Config, ShowErrorMsg) {try {void 0 === ShowErrorMsg && (ShowErrorMsg = !0); var ErrorMsgDIVID = Config.ColumnName + Config.DataRowUniqueKey.replace(/\./ig, "_") + "ErrorDIV", IsValid = !0, Value = "", ErrorMsg = ""; if ("TEXT" == Config.ColumnType || "TEXTAREA" == Config.ColumnType || "HIDDEN" == Config.ColumnType || "PASSWORD" == Config.ColumnType || "HtmlEditor" == Config.ColumnType || "TREE" == Config.ColumnType) Value = "HtmlEditor" == Config.ColumnType ? HtmlControlHtmlEditorGetValue(Config.ColumnName) : GetInputElementValue(HtmlControlObject), Config.IsNotAllowNullValueField ? null == Value || "" == Value ? (IsValid = !1, ErrorMsg = Config.hasOwnProperty("NullValueAlertText") && Config.NullValueAlertText.length > 0 ? Config.NullValueAlertText : "值不能为空！") : Config.MinLength.length > 0 && Value.length < parseInt(Config.MinLength) ? (IsValid = !1, ErrorMsg = "当前长度:<b>" + Value.length + "</b>,不能少于<b>" + Config.MinLength + "</b>个字符！") : Config.MaxLength.length > 0 && Value.length > parseInt(Config.MaxLength) && (IsValid = !1, ErrorMsg = "当前长度:<b>" + Value.length + "</b>,不能超过<b>" + Config.MaxLength + "</b>个字符！") : null != Value && Value.length > 0 && (Config.MinLength.length > 0 && Value.length < parseInt(Config.MinLength) ? (IsValid = !1, ErrorMsg = "当前长度:<b>" + Value.length + "</b>,不能少于<b>" + Config.MinLength + "</b>个字符！") : Config.MaxLength.length > 0 && Value.length > parseInt(Config.MaxLength) && (IsValid = !1, ErrorMsg = "当前长度:<b>" + Value.length + "</b>,不能超过<b>" + Config.MaxLength + "</b>个字符！")), !IsValid && ShowErrorMsg && AlertHtmlControlField(HtmlControlObject); else if ("DATE" == Config.ColumnType) {if (Value = GetInputElementValue(HtmlControlObject), Config.IsNotAllowNullValueField && (null == Value || "" == Value) && (IsValid = !1, ErrorMsg = Config.hasOwnProperty("NullValueAlertText") && Config.NullValueAlertText.length > 0 ? Config.NullValueAlertText : "值不能为空！"), IsValid) {var DateValue = Date.parser(Value, "Y-m-d"); void 0 === DateValue ? (IsValid = !1, ErrorMsg = "非法的日期！") : Config.MinValue.length > 0 && DateValue < Date.parser(Config.MinValue, "Y-m-d") ? (IsValid = !1, ErrorMsg = "当前日期:<b>" + Value + "</b>,不能小于<b>" + Config.MinValue + "</b>！") : Config.MaxValue.length > 0 && NumberValue > Date.parser(Config.MaxValue, "Y-m-d") && (IsValid = !1, ErrorMsg = "当前日期:<b>" + Value + "</b>,不能大于<b>" + Config.MaxValue + "</b>！")} !IsValid && ShowErrorMsg && AlertHtmlControlField(HtmlControlObject)} else if ("CHECKBOX" == Config.ColumnType) Element.checked(HtmlControlObject) ? Value = GetInputElementValue(HtmlControlObject) : !Array.contains(VerifiedHtmlControlArray, Config.ObjectName) && Config.IsNotAllowNullValueField && (0 == GetCheckBoxValue(Config.ObjectName).length ? (IsValid = !1, ErrorMsg = "必须选择一个选项！") : UpdateDivContentByID(ErrorMsgDIVID, "")); else if ("SELECT" == Config.ColumnType) Value = GetInputElementValue(HtmlControlObject), Config.IsNotAllowNullValueField && (null == Value || "" == Value) && (IsValid = !1, ErrorMsg = "必须选择一个非空项！"), !IsValid && ShowErrorMsg && AlertHtmlControlField(HtmlControlObject); else if ("RADIO" == Config.ColumnType) Element.checked(HtmlControlObject) ? Value = GetInputElementValue(HtmlControlObject) : !Array.contains(VerifiedHtmlControlArray, Config.ObjectName) && Config.IsNotAllowNullValueField && (0 == GetRadioValue(Config.ObjectName).length ? (IsValid = !1, ErrorMsg = "必须选择一个选项！") : UpdateDivContentByID(ErrorMsgDIVID, "")); else if ("NUMBER" == Config.ColumnType || "INT" == Config.ColumnType) {if (Value = GetInputElementValue(HtmlControlObject), null != Value && Value.indexOf(",") > 0 && (Value = Value.replace(/,/ig, ""), Element.SetValue(HtmlControlObject, Value)), Config.IsNotAllowNullValueField) {if (Config.IsNotAllowNullValueField && (null == Value || "" == Value)) IsValid = !1, ErrorMsg = Config.hasOwnProperty("NullValueAlertText") && Config.NullValueAlertText.length > 0 ? Config.NullValueAlertText : "值不能为空！"; else if ("NUMBER" != Config.ColumnType || IsNumber(Value)) {if ("INT" != Config.ColumnType || IsInt(Value)) {var NumberValue = parseFloat(Value); Config.MinValue.length > 0 && NumberValue < parseFloat(Config.MinValue) ? (IsValid = !1, ErrorMsg = "当前值:<b>" + Value + "</b>,不能小于<b>" + Config.MinValue + "</b>！") : Config.MaxValue.length > 0 && NumberValue > parseFloat(Config.MaxValue) ? (IsValid = !1, ErrorMsg = "当前值:<b>" + Value + "</b>,不能大于<b>" + Config.MaxValue + "</b>！") : Config.MinLength.length > 0 && Value.length < parseInt(Config.MinLength) ? (IsValid = !1, ErrorMsg = "当前长度:<b>" + Value.length + "</b>,不能少于<b>" + Config.MinLength + "</b>个字符！") : Config.MaxLength.length > 0 && Value.length > parseInt(Config.MaxLength) && (IsValid = !1, ErrorMsg = "当前长度:<b>" + Value.length + "</b>,不能超过<b>" + Config.MaxLength + "</b>个字符！")} else IsValid = !1, ErrorMsg = "非法的数值，必须为整数！"} else IsValid = !1, ErrorMsg = "非法的数值！"} else if (null != Value && Value.length > 0) try {if ("NUMBER" != Config.ColumnType || IsNumber(Value)) {if ("INT" != Config.ColumnType || IsInt(Value)) {var NumberValue = parseFloat(Value); Config.hasOwnProperty("MinValue") && Config.MinValue.length > 0 && NumberValue < parseFloat(Config.MinValue) ? (IsValid = !1, ErrorMsg = "当前值:<b>" + Value + "</b>,不能小于<b>" + Config.MinValue + "</b>！") : Config.hasOwnProperty("MaxValue") && Config.MaxValue.length > 0 && NumberValue > parseFloat(Config.MaxValue) ? (IsValid = !1, ErrorMsg = "当前值:<b>" + Value + "</b>,不能大于<b>" + Config.MaxValue + "</b>！") : Config.MinLength.length > 0 && Value.length < parseInt(Config.MinLength) ? (IsValid = !1, ErrorMsg = "当前长度:<b>" + Value.length + "</b>,不能少于<b>" + Config.MinLength + "</b>个字符！") : Config.MaxLength.length > 0 && Value.length > parseInt(Config.MaxLength) && (IsValid = !1, ErrorMsg = "当前长度:<b>" + Value.length + "</b>,不能超过<b>" + Config.MaxLength + "</b>个字符！")} else IsValid = !1, ErrorMsg = "非法的数值，必须为整数！"} else IsValid = !1, ErrorMsg = "非法的数值！"} catch (ex) {IsValid = !1, ErrorMsg = ex.toString()} !IsValid && ShowErrorMsg && AlertHtmlControlField(HtmlControlObject)} if (Array.include(VerifiedHtmlControlArray, Config.ObjectName), !IsValid && ShowErrorMsg) UpdateDivContentByID(ErrorMsgDIVID, GetAlertMsgHTML(ErrorMsg)); else {if (Config.CustomizedValidate.length > 0) try {var Result = eval(Config.CustomizedValidate + "(HtmlControlObject,Value)"); IsValid = Result.IsValid, Value = Result.Value, ErrorMsg = Result.ErrorMsg} catch (e) {alert("<b>" + Config.ObjectName + "</b>的自定义验证返回值不正确或执行失败！原因：" + e.message), IsValid = !1} if (IsValid || !ShowErrorMsg) return {DataRowUniqueKey: Config.DataRowUniqueKey, ColumnName: Config.ColumnName, Value: Value}; ("TEXT" == Config.ColumnType || "TEXTAREA" == Config.ColumnType || "DATE" == Config.ColumnType || "SELECT" == Config.ColumnType || "NUMBER" == Config.ColumnType) && AlertHtmlControlField(HtmlControlObject), UpdateDivContentByID(ErrorMsgDIVID, GetAlertMsgHTML(ErrorMsg))} } catch (e) { } return !1} function AlertHtmlControlField(e) {try {if (CheckIsMobileV5()) {var n = $(".PlaceHolder", e.parents(".RightTD").first()); n.length > 0 && window.setTimeout(function () {Element.AddClass(n, "Hidden"); var o = $(".AlertMsgDIVNew", e.parents(".RightTD").first()); Element.AppendAfterByElement(n, '<div class="EmptyAlertFieldMobileV5 EmptyAlertField">' + Element.GetText(o) + "</div>")}, 500)} else e.addClass("EmptyAlertField")} catch (o) { } } function RemoveAllHtmlControlErrorMsg(e) {void 0 === e && (e = ""); try {var n = (e.length > 0 ? "#" + e + " " : "") + ".EmptyAlertField"; $(n).removeClass("EmptyAlertField")} catch (o) { } try {var n = (e.length > 0 ? "#" + e + " " : "") + ".HtmlControlErrorDIV"; $(n).foreach(function (e, n) {UpdateDivContent($(e), "")})} catch (a) { } } function HtmlControlHtmlEditorGetValue(e) {return GetHtmlEditorContent(e)} function HtmlControlHtmlEditorSetValue(e, n) {SetHtmlEditorContent(e, n)} function HtmlControlHtmlEditorAppendHTML(e, n) {SetHtmlEditorContent(e, GetHtmlEditorContent(e) + n)} function 修改控件属性(控件ID, Config) {if (DomHasElement(控件ID)) {var CurrentConfig = eval("(" + Element.GetAttribute($("#" + 控件ID), "rel") + ")"); if (void 0 !== CurrentConfig) {for (var key in Config) CurrentConfig[key] = Config[key]; Element.SetAttribute($("#" + 控件ID), "rel", JSON.encode(CurrentConfig).replace(/"/ig, "'"))} } } function 修改控件属性ByElement(element, Config) {var CurrentConfig = eval("(" + Element.GetAttribute(element, "rel") + ")"); if (void 0 !== CurrentConfig) {for (var key in Config) CurrentConfig[key] = Config[key]; Element.SetAttribute(element, "rel", JSON.encode(CurrentConfig).replace(/"/ig, "'"))} } function 获得控件属性(控件ID, AttributeName) {if (DomHasElement(控件ID)) {var CurrentConfig = eval("(" + Element.GetAttribute($("#" + 控件ID), "rel") + ")"); if (void 0 !== CurrentConfig) return CurrentConfig.hasOwnProperty(AttributeName) ? CurrentConfig[AttributeName] : null} return null} var HtmlControlCustomizedValidate = {IsNumber: function (e, n) {return {IsValid: !(n.length > 0) || IsNumber(n), Value: n, ErrorMsg: "无效的数值"}}, IsInt: function (e, n) {return {IsValid: !(n.length > 0) || IsInt(n), Value: n, ErrorMsg: "必须为整数"}}, IsValidMobilePhone: function (e, n) {return {IsValid: !(n.length > 0) || IsValidMobilePhone(n), Value: n, ErrorMsg: "无效的手机号码"}}, IsPhoneNumber: function (e, n) {return {IsValid: !(n.length > 0) || IsPhoneNumber(n), Value: n, ErrorMsg: "无效的电话号码"}}, IsValidEmail: function (e, n) {return {IsValid: !(n.length > 0) || IsValidEmail(n), Value: n, ErrorMsg: "邮箱地址格式不正确"}}, IsValidGuid: function (e) {return {IsValid: !(e.length > 0) || IsValidGuid(e), Value: e, ErrorMsg: "GUID格式不正确"}}, IsValidIPAddress: function (e) {return {IsValid: !(e.length > 0) || IsValidIPAddress(e), Value: e, ErrorMsg: "IP地址格式不正确"}}, IsValidEnglishAndNumber: function (e, n) {return {IsValid: 0 == n.replace(/[:a-zA-Z0-9_-]*/ig, "").length, Value: n, ErrorMsg: "只能输入英文和数字"}}, IsBankNumber: function (e, n) {return {IsValid: !(n.length > 0) || IsBankNumber(n), Value: n, ErrorMsg: "无效的银行账号!"}}, IsPlateNumber: function (e, n) {return {IsValid: !(n.length > 0) || IsPlateNumber(n), Value: n, ErrorMsg: "无效的车牌号!"}}, IsVehicleIdentificationNumber: function (e, n) {return {IsValid: !(n.length > 0) || IsVehicleIdentificationNumber(n), Value: n, ErrorMsg: "无效的车架号!"}}}; function CreateNewHtmlControl(e, n, o, a, l, r, s, c, d, u, p, m, g, f) {void 0 === g && (g = null), void 0 === f && (f = null), LoadServiceClass.LoadServiceInterface("创建控件", "CustomizedWCFUI.ServiceFactory.Public.PublicClass", "CreateNewHtmlControl", !0, e, GetLoadingMsg("正在加载..."), {IsMetroStyle: n, DataRowUniqueKey: o, ObjectID: a, HtmlControlType: l, DataSoureJSON: null == r ? "" : JSON.encode(r), IsSystemFrameWork: s, DataSoureSql: c, DataSourceKeyColumn: d, DataSourceValueColumn: u, DefaultValue: p, ExtraProperties: null == m ? "" : JSON.encode(m)}, g, f, {ActionName: "创建控件"})} function HtmlControlAddMinusNumber(e, n) {if (DomHasElement(e)) {var o = String.trim(document.getElementById(e).value), a = parseFloat(o.length > 0 ? o : 0); a += n; var l = 获得控件属性(e, "MinValue"); l.length > 0 && (a = Math.max(a, parseFloat(l))); var r = 获得控件属性(e, "MaxValue"); r.length > 0 && (a = Math.min(a, parseFloat(r))), document.getElementById(e).value = a, $("#" + e).fireEvent("change")} } function ApplyPageLayoutTemplateHTML(e, n, o, a, l, r, s, c) {LoadService(!0, n, GetLoadingMsg("正在加载..."), {IsMobileV5: e, ContainerDIVID: n, PageLayoutTemplateHTML: o, FormKey: a, DataTableName: l, ColumNameList: r}, function () {window.setTimeout(function () {s()}, 500)}, c, {ActionName: "加载界面布局模板"}, 1, "CustomizedWCFUI.ServiceFactory.Public.PublicClass|ApplyPageLayoutTemplateHTML")} var CommonTreeClass = {ObjectIDSettingDictionary: {}, Config: {TreeObject: null, ObjectID: "", ContainerDIVID: "", CurrentValue: "", NodeList: [], OnSelectCallBack: null}, AjaxLoadTree: function (ContainerDIVID, RootNodeName, ExpandNodeLevel, OnSelectCallBack, SuccessCallBack, ErrorCallBack, StatusDictionary, EnableCheckBox) {void 0 === EnableCheckBox && (EnableCheckBox = !1); var setting = {check: {enable: EnableCheckBox}, data: {simpleData: {enable: !0}}, view: {showIcon: !0, nameIsHTML: !0, showTitle: !0}, callback: {onClick: function (e, n, o) {null != OnSelectCallBack && OnSelectCallBack.call(this, o.FullPathValue)}}}; document.getElementById(ContainerDIVID).innerHTML = GetLoadingMsg("正在加载" + RootNodeName + "..."), void 0 === StatusDictionary && (StatusDictionary = {}), LoadServiceClass.LoadServiceInterface("加载" + RootNodeName, "CustomizedWCFUI.ServiceFactory.SystemSetting.CommonTreeClass", "AjaxLoadTree", !1, "", "", {RootNodeName: RootNodeName, ExpandNodeLevel: ExpandNodeLevel, StatusDictionary: JSON.encode(StatusDictionary)}, function (返回值) {var NodeList = eval("(" + 返回值.Result + ")"), treeobject = $.fn.zTree.init($("#" + ContainerDIVID), setting, NodeList); SuccessCallBack.call(this, treeobject, NodeList)}, ErrorCallBack, {ActionName: "加载" + RootNodeName})}, Initiate: function (e, n, o, a, l) {void 0 === o && (o = ""); var r = {check: {enable: !1}, data: {simpleData: {enable: !0}}, view: {showIcon: !0, nameIsHTML: !0, showTitle: !0}, callback: {onClick: function (n, o, a) {var r = CommonTreeClass.GetFullPathValue(a); (null == r || void 0 === r) && (r = a.corename), (null == r || void 0 === r) && (r = ""), Element.SetValue($("#" + e), r), Element.SetHtml($("#" + e + "_SelectedStatusSPAN"), r.length > 0 ? r : "无"), null != l && l.call(this, e, r); var s = e + "_CommonTree_OnSelectCallBack"; PageDynamicObject.hasOwnProperty(s) && PageDynamicObject[s].call(this, e, r, o, a)}}}, s = {TreeObject: null, ObjectID: e, ContainerDIVID: n, CurrentValue: o, NodeList: a, OnSelectCallBack: l}; if (s.TreeObject = $.fn.zTree.init($("#" + n), r, a), CommonTreeClass.ObjectIDSettingDictionary[e] = s, o.length > 0) {for (var a = CommonTreeClass.GetAllNode(s.TreeObject), c = null, d = 0; d < a.length; d++)if (a[d].FullPathValue == o) {c = a[d]; break} null != c && (s.TreeObject.selectNode(c), s.TreeObject.expandAll(!1))} }, SetValue: function (e, n) {if (n.length > 0 && "--" != n && CommonTreeClass.ObjectIDSettingDictionary.hasOwnProperty(e)) {for (var o = CommonTreeClass.ObjectIDSettingDictionary[e], a = CommonTreeClass.GetAllNode(o), l = null, r = 0; r < a.length; r++)if (a[r].FullPathValue == n) {l = a[r]; break} null != l && (o.selectNode(l), o.expandAll(!1)), Element.SetValue($("#" + e), n)} }, GetFullPathValue: function (e) {return null != e ? e.FullPathValue : ""}, InitiateTree: function (ContainerDIVID) {var elements = $((void 0 !== ContainerDIVID && ContainerDIVID.length > 0 ? "#" + ContainerDIVID + " " : "") + ".HtmlControlZTree"); elements.length > 0 && elements.foreach(function (item, index) {var OwnerObjectID = item.id, rel = Element.GetAttribute($(item), "rel"); if (void 0 !== rel && rel.length > 0) {var Config = eval("(" + Element.GetAttribute($(item), "rel") + ")"), ObjectID = Config.ObjectID; ObjectID.indexOf("<$DataRowUniqueKey$>") > 0 && (ObjectID = ObjectID.replace("<$DataRowUniqueKey$>", OwnerObjectID.split("_")[2])); var TreeNodeList = eval("(" + Config.TreeNodeList.replace(/&quot;/ig, '"') + ")"), CurrentValue = Element.GetValue($("#" + ObjectID)); CommonTreeClass.Initiate(ObjectID, ObjectID + "_ControlContainerDIV", CurrentValue, TreeNodeList, function () { })} })}, GetAllNode: function (e) {var n = []; return e.getNodes().foreach(function (e, o) {CommonTreeClass.GetChildrenNode(n, e)}), n}, GetChildrenNode: function (e, n) {Array.include(e, n), n.hasOwnProperty("children") && n.children.length > 0 && n.children.foreach(function (n, o) {Array.include(e, n), CommonTreeClass.GetChildrenNode(e, n)})}}; function RSAEncrypt(e) {var n = "-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxk5yvzJhWHgSU2e5++CbX4OP0XGQSi0OIErcZ/mmD46ZMzZFiXAOsbLeYhvwdAaXTqzvE34ZXAkhN/ioz2a/09B7CT8TWiomsLexGbiZYC1YrDJRWqv1QvmnHjyJ4fqH+qk0QQqp2IJLUbuduc7clCxU8H/vKL3PpSDS/Q0mOgViONnqlp/7TzBb3nCJMOTaq3ditFFCVOOwf9fay286bAhXyuU4DyT9lxyKRrxbndSi5XUaaY9VPz4Y0V1x7ln13OZwKeaZLuZjFvWQCfvjyl+NtXprdNTkQVkoKDFIHgktVSmb8D+wZ5IONz2MKq9Np2tX+NsgmnW0Oa1DacPONwIDAQAB-----END PUBLIC KEY-----", o = new JSEncrypt; return o.setPublicKey(n), o.encrypt(e)} function ToogleTabContent(e, n) {Element.RemoveClass($(".tab-line .FocusTab", e), "FocusTab"), Element.AddClass($(".tab-line ." + n, e), "FocusTab"), Element.RemoveByElement($(".tab-line .FocusLineContainerDIV", e)), Element.AppendByElement($(".tab-line ." + n, e), "<div class='FocusLineContainerDIV'><div class='FocusLineDIV'></div></div>"), Element.AddClass($(".tab-content", e), "Hidden"), Element.RemoveClass($("#" + n, e), "Hidden")} var UserClass = {LoadUserHomePage: function () {window.location.href = "App.aspx"}, SendVerifyCode: function (e, n) {var o = String.trim(Element.GetValue($("#LoginUsername"))); 0 == o.length ? PopupToastMessage("info", "请输入11位手机号") : IsValidMobilePhone(o) ? (ShowLoadingStatusDIV(null, "正在发送验证码..."), AjaxLoader(!1, "Ajax/SendVerifyCode.aspx?Version=" + Math.random(), "", "", {IsSignup: e, PhoneNumber: o}, function () {HideLoadingStatusDIV(), PopupToastMessage("info", "已发送验证码，请查收"), n()}, function (e) {HideLoadingStatusDIV(), PopupToastMessage("info", e.ErrorMsg)}, {ActionName: "发送验证码"})) : PopupToastMessage("info", "无效的手机号码")}, SignupSendVerifyCode: function () {UserClass.SendVerifyCode(!0, function () {UserClass.InitiateWaitingTimer()})}, WaitingTimer: 0, InitiateWaitingTimer: function () {UserClass.WaitingTimer = 60, Element.SetAttribute($("#SendVerifyCodeButton"), "disabled", "disabled"), UserClass.CheckWaitingTimer()}, CheckWaitingTimer: function () {UserClass.WaitingTimer > 0 ? (Element.SetText($("#SendVerifyCodeButton"), UserClass.WaitingTimer + "秒后重新获取"), window.setTimeout(function () {UserClass.WaitingTimer--, UserClass.CheckWaitingTimer()}, 1e3)) : (Element.SetText($("#SendVerifyCodeButton"), "发送验证码"), Element.RemoveAttribute($("#SendVerifyCodeButton"), "disabled"))}, Signup: function () {var e = String.trim(Element.GetValue($("#CompanyName"))), n = String.trim(Element.GetValue($("#ContactUserName"))), o = String.trim(Element.GetValue($("#LoginUsername"))), a = String.trim(Element.GetValue($("#VerifyCode"))); String.trim(Element.GetValue($("#LoginPassword"))), String.trim(Element.GetValue($("#ReLoginPassword"))), 0 == e.length ? PopupToastMessage("info", "请输入公司名称") : 0 == n.length ? PopupToastMessage("info", "请输入您的姓名") : 0 == o.length ? PopupToastMessage("info", "请输入手机号码") : IsValidMobilePhone(o) ? 0 == a.length ? PopupToastMessage("info", "请输入6位验证码") : 6 == a.length && IsNumber(a) ? (ShowLoadingStatusDIV(null, "正在注册..."), AjaxLoader(!1, "Ajax/Signup.aspx?Version=" + Math.random(), "", "", {CompanyName: e, ContactUserName: n, LoginUsername: o, VerifyCode: a}, function () {HideLoadingStatusDIV(), PopupToastMessage("info", "注册成功"), ShowLoadingStatusDIV(null, "正在加载..."), UserClass.LoadUserHomePage()}, function (e) {HideLoadingStatusDIV(), PopupToastMessage("info", e.ErrorMsg)}, {ActionName: "注册"})) : PopupToastMessage("info", "无效的验证码，必须为6位数字") : PopupToastMessage("info", "无效的手机号码")}, LoginSendVerifyCode: function () {UserClass.SendVerifyCode(!1, function () {UserClass.InitiateWaitingTimer()})}, Login: function () {var e = String.trim(Element.GetValue($("#LoginUsername"))), n = String.trim(Element.GetValue($("#VerifyCode"))); 0 == e.length ? PopupToastMessage("info", "请输入手机号码") : IsValidMobilePhone(e) ? 0 == n.length ? PopupToastMessage("info", "请输入6位验证码") : 6 == n.length && IsNumber(n) ? (ShowLoadingStatusDIV(null, "正在登录..."), AjaxLoader(!1, "Ajax/Login.aspx?Version=" + Math.random(), "", "", {LoginUsername: e, VerifyCode: n}, function () {HideLoadingStatusDIV(), PopupToastMessage("info", "登录成功"), ShowLoadingStatusDIV(null, "正在加载..."), UserClass.LoadUserHomePage()}, function (e) {HideLoadingStatusDIV(), PopupToastMessage("info", e.ErrorMsg)}, {ActionName: "登录"})) : PopupToastMessage("info", "无效的验证码，必须为6位数字") : PopupToastMessage("info", "无效的手机号码")}}, SystemBrowserLoadPageClass = {URLTabDictionary: {}, TabCallerDictionary: {}, LoadPage: function (e, n) {if (Element.AddClass($(".main-container-inner"), "OverFlowHidden"), DomHasElement("SystemBrowserTabsToolBarDIV")) {var o = ""; if (SystemBrowserLoadPageClass.URLTabDictionary.hasOwnProperty(n)) {o = SystemBrowserLoadPageClass.URLTabDictionary[n]; try {document.getElementById(o + "_PageTaskWindowIframe").src = n + (n.indexOf("?") > 0 ? 0 == n.split("?").last().length ? "" : "&" : "?") + "IsTabMode=true&IframeHeight=" + l + "&IframeTabID=" + o} catch (a) { } } else {o = SystemBrowserLoadPageClass.NewTab(e), SystemBrowserLoadPageClass.URLTabDictionary[n] = o; var l = Element.Size($(".main-container")).height - 80; n = n + (n.indexOf("?") > 0 ? 0 == n.split("?").last().length ? "" : "&" : "?") + "IsTabMode=true&IframeHeight=" + l + "&IframeTabID=" + o, Element.AppendByElement($("#" + o), "<div id='" + o + "_PageTaskWindowIframeStatusDIV' style='padding:10px;'>" + GetLoadingMsg("正在加载...") + "</div><iframe style='width:100%; height:" + l + "px; border:0px; overflow:auto;' id='" + o + "_PageTaskWindowIframe' src='" + n + "' class='Hidden' scrolling='yes'></iframe>"), BlindEvent($("#" + o + "_PageTaskWindowIframe"), {load: function () {Element.Remove("" + o + "_PageTaskWindowIframeStatusDIV"), Element.RemoveClass($("#" + o + "_PageTaskWindowIframe"), "Hidden")}}); var r = $("#SystemBrowserTabsListDIV .SystemBrowserTab"); if (r.length > 8) {var s = r[1].id; SystemBrowserLoadPageClass.Close(s)} } Element.RemoveClass($(".SystemBrowserTabContentContainer"), "active"), Element.RemoveClass($("#SystemBrowserTabsListDIV .active"), "active"), Element.AddClass($("#" + o + "_tab").parent(), "active"), Element.AddClass($("#" + o), "active")} else SystemBrowserLoadPageClass.CreateTabContainer(n, e)}, CreateTabContainer: function (e, n) {var o = "SystemBrowserTabContentContainer1"; SystemBrowserLoadPageClass.URLTabDictionary[e] = o; var a = Element.Size($(".main-container")).height - 80; e = e + (e.indexOf("?") > 0 ? 0 == e.split("?").last().length ? "" : "&" : "?") + "IsTabMode=true&IframeHeight=" + a + "&IframeTabID=" + o; var l = ""; l += '                <div class="nav-tabs-horizontal nav-tabs-inverse" data-plugin="tabs" id="SystemBrowserTabsToolBarDIV" style=\'padding:10px 0px 0px 0px;\'>', l += "                  <div class='Relative' id='SystemBrowserTabsListContainerDIV'>", l += '                  <ul class="nav nav-tabs nav-tabs-solid" role="tablist" id="SystemBrowserTabsListDIV">', l += '                    <li class="nav-item active" role="presentation">', l += '                      <a class="nav-link SystemBrowserTab" data-toggle="tab" href="#SystemBrowserTabContentContainer1" aria-controls="SystemBrowserTabContentContainer1" role="tab" id="SystemBrowserTabContentContainer1_tab">' + n + "</a>", l += "                    </li>", l += "                  </ul>", l += "                  </div>", l += '                  <div class="tab-content" id="SystemBrowserTabContentContainer">', l += '                    <div class="tab-pane active SystemBrowserTabContentContainer" id="SystemBrowserTabContentContainer1" role="tabpanel"><div id=\'' + o + "_PageTaskWindowIframeStatusDIV' style='padding:10px;'>" + GetLoadingMsg("正在加载...") + "</div><iframe style='width:100%; height:" + a + "px; border:0px; overflow:auto;' id='" + o + "_PageTaskWindowIframe' src='" + e + "' class='Hidden' scrolling='yes'></iframe></div>", l += "                  </div>", l += "                </div>", Element.AppendByElement($(".main-container"), l), Element.AppendByElement($("#SystemBrowserTabContentContainer1"), $(".main-container-inner-padding")), BlindEvent($("#" + o + "_PageTaskWindowIframe"), {load: function () {Element.Remove("" + o + "_PageTaskWindowIframeStatusDIV"), Element.RemoveClass($("#" + o + "_PageTaskWindowIframe"), "Hidden")}})}, NewTab: function (e) {var n = NewGuid().replace(/-/ig, ""), o = ""; return o += '                    <li class="nav-item" role="presentation">', o += '                      <a class="nav-link SystemBrowserTab" data-toggle="tab" href="#' + n + '" aria-controls="' + n + '"  role="tab" id="' + n + '_tab">', o += '                       <span class="close" data-close="tab" aria-label="Close" onclick="SystemBrowserLoadPageClass.Close(\'' + n + "')\">", o += '                          <strong title="关闭标签">\xd7</strong>', o += "                        </span>", o += e, o += "                      </a>", o += "                    </li>", Element.AppendByElement($("#SystemBrowserTabsListDIV"), o), Element.AppendByElement($("#SystemBrowserTabContentContainer"), '<div class="tab-pane active SystemBrowserTabContentContainer" id="' + n + '" role="tabpanel"></div>'), n}, GetURL: function (e) {var n = ""; for (var o in SystemBrowserLoadPageClass.URLTabDictionary) SystemBrowserLoadPageClass.URLTabDictionary[o] == e && (n = o); return n}, Refresh: function (e) {for (var n in SystemBrowserLoadPageClass.URLTabDictionary) SystemBrowserLoadPageClass.URLTabDictionary[n] == e && (document.getElementById(e + "_PageTaskWindowIframe").src = document.getElementById(e + "_PageTaskWindowIframe").src)}, RefreshTabByURL: function (e) {var n = ""; try {for (var o in e = e.toLowerCase(), SystemBrowserLoadPageClass.URLTabDictionary) if (o.toLowerCase().indexOf(e) >= 0) {n = SystemBrowserLoadPageClass.URLTabDictionary[o], document.getElementById(n + "_PageTaskWindowIframe").contentWindow.RefreshGrid(); break} } catch (a) {console.log("[TabID:" + n + "]RefreshTabByURL Error:" + a.toString())} }, Close: function (e) {if (Element.HasClass($("#" + e + "_tab").parent(), "active")) {var n = $("#" + e + "_tab").parent(), o = $($(n).prev()); $(".nav-link", o).fireEvent("click")} Element.RemoveByElement($("#" + e + "_tab").parent()), Element.RemoveByElement($("#" + e)); var a = SystemBrowserLoadPageClass.GetURL(e); delete SystemBrowserLoadPageClass.URLTabDictionary[a]}, GetPrevTabID: function (e) {var n = $("#" + e + "_tab").parent(), o = $($(n).prev()); return $(".SystemBrowserTab", o)[0].id}, InitiateScrollBar: function () { }}; function DisplaySearchResult() {Array.include(SearchKeywordList, SearchKeyword); var e = ""; e += '<div class="container">', e += "<div class='SearchResultTitle'>查询结果(<span class='SearchTotalResult'>" + SearchResultList.length + "</span>)：</div>", e += "</div>", e += "<div id='SearchResultDataListDIV'></div>", e += "<div id='SearchResultPageListDIV'></div>", Element.SetHtml($("#SearchResultContainerDIV"), e), HTMLGridClass.Config.TotalResult = SearchResultList.length, HTMLGridClass.Config.PageListContainerID = "SearchResultPageListDIV", HTMLGridClass.Config.FormatDataList = function () {var e = "", n = (HTMLGridClass.Config.PageNo - 1) * HTMLGridClass.Config.PageSize, o = HTMLGridClass.Config.PageNo * HTMLGridClass.Config.PageSize - 1; SearchResultList.foreach(function (a, l) {if (n <= l && o >= l) {var r = a.简介.length > 200 ? a.简介.substring(0, 200) + "..." : a.简介; e += '<section class="CommonAreaContainer ' + (l % 2 == 0 ? "" : "CommonAreaContainerBgColor") + '">', e += '<div class="container">'; var s = "Document.aspx?DirectoryID=" + a.分类 + "&DocumentID=" + a.ID; e += "<div class='SearchResult'>", e += "<div class='Title'><a href=\"" + s + '" target="_blank">' + AddSearchTag(a.标题) + "</a></div>", e += "<div class='DirectoryPath'>" + a.路径 + " <div class='ClearFloat'></div></div>", e += "<div class='SearchDescription'>" + AddSearchTag(r) + "</div>", e += "<div class='Date'>发布日期：" + a.发布日期 + '</div><a href="' + s + '" target="_blank" class=\'MoreInfoLink badge badge-round badge-primary\'>详情</a>', e += "</div>", e += "</div>", e += "</section>"} }), Element.SetHtml($("#SearchResultDataListDIV"), e)}, HTMLGridClass.LoadData()} function AddSearchTag(value) {return SearchKeywordList.foreach(function (item, index) {var reg = eval("(/" + item + "/ig)"); value = value.replace(reg, "<span class='MatchTag'>" + item + "</span>")}), value} var HTMLGridClass = {Config: {PageSize: 5, PageNo: 1, TotalResult: 0, PageListContainerID: "", FormatDataList: null}, ShowPageList: function (e, n, o) {HTMLGridClass.Config.TotalResult = o, HTMLGridClass.Config.TotalPage = HTMLGridClass.GetTotalPage(e, o); var a = HTMLGridClass.GetMinMaxShowPageNo(n, HTMLGridClass.Config.TotalPage), l = ""; if (o > 0) {l += "<div class='container'>", l += "<nav>", l += '<ul class="pagination pagination-no-border">', l += '<li class="' + (1 == n ? "disabled" : "") + ' page-item">', l += '<a class="page-link" href="javascript:' + (1 == n ? "void(0)" : "HTMLGridClass.GoToPage(" + (n - 1) + ")") + '" aria-label="上一页">', l += '<span aria-hidden="true">&laquo;</span>', l += "</a>", l += "</li>"; for (var r = a.Min; r <= a.Max; r++)l += n == r ? '<li class="active page-item"><a class="page-link" href="javascript:HTMLGridClass.GoToPage(' + r + ')">' + r + ' <span class="sr-only">(current)</span></a></li>' : '<li class="page-item"><a class="page-link" href="javascript:HTMLGridClass.GoToPage(' + r + ')">' + r + "</a></li>"; l += '<li class="' + (n == this.Config.TotalPage ? "disabled" : "") + ' page-item">', l += '<a class="page-link" href="javascript:' + (n == this.Config.TotalPage ? "void(0)" : "HTMLGridClass.GoToPage(" + (n + 1) + ")") + '" aria-label="下一页">', l += '<span aria-hidden="true">&raquo;</span>', l += "</a>", l += "</li>", l += "</ul>", l += "</nav>", l += "</div>"} document.getElementById(HTMLGridClass.Config.PageListContainerID).innerHTML = l}, GetTotalPage: function (e, n) {var o = 0; return n <= e ? o = 1 : (o = Math.floor(n / e), n % e > 0 && (o += 1)), o}, GetMinMaxShowPageNo: function (e, n) {var o = 0, a = 0; return (a = e >= 10 & e % 10 == 0 ? e + 5 : e < 10 ? 10 : e / 10 * 10 + 10) > n && (a = n), (o = a - 10) < 1 && (o = 1), {Min: o, Max: a}}, GoToPage: function (e) {HTMLGridClass.Config.PageNo = e, HTMLGridClass.LoadData()}, ChangePageSize: function (e) {HTMLGridClass.Config.PageSize = e, HTMLGridClass.LoadData()}, LoadData: function () {HTMLGridClass.Config.FormatDataList(), HTMLGridClass.ShowPageList(HTMLGridClass.Config.PageSize, HTMLGridClass.Config.PageNo, HTMLGridClass.Config.TotalResult)}}; function ToogleSaleTag(e, n) {Element.AddClass($(".SaleSection"), "Hidden"), Element.RemoveClass($("." + e), "Hidden"), Element.RemoveClass($(".TagFocus"), "TagFocus"), Element.AddClass($("#" + e + "Tag"), "TagFocus"), void 0 === n || n ? (ShowLoadingStatusDIV(null, "正在加载..."), AjaxLoader(!1, "Ajax/SetCustomerServiceState.aspx?version=" + Math.random(), "", "", {UserGuid: UserInfo.UserGuid, FocusTagID: e}, function () {HideLoadingStatusDIV(), "SaleSection3" == e && CustomerServiceClass.LoadRTList()}, Common_Error)) : "SaleSection3" == e && CustomerServiceClass.LoadRTList()} var ListGroupClass = {Display: function (e, n, o) {var a = $("<div class='list-group'></div>"); Element.Append(e, a), n.foreach(function (e, n) {html = "", html += '<a class="list-group-item list-group-item-action flex-column align-items-start" href="javascript:void(0)">', html += '<h4 class="list-group-item-heading mt-0 mb-5" style="font-size:14px; font-weight:bold;color:#0064FF;">' + e.Title + "</h4>", e.Description.length > 0 && (html += '<p class="mb-0">' + e.Description + "</p>"); var l = $(html += "</a>"); Element.AppendByElement(a, l), BlindEvent(l, {click: function () {o(e.value)}})})}}, CustomerServiceClass = {Abort: function () {if (null != CustomerServiceClass.AjaxLoader) try {CustomerServiceClass.AjaxLoader.abort()} catch (e) { } }, InitiateWorkFlow: function () {if (0 == Object.Length(UserSystemSerialNumberDictionary)) PopupToastMessage("info", "请先绑定产品序列号"); else if (1 == Object.Length(UserSystemSerialNumberDictionary)) {var e = 0, n = ""; for (var o in UserSystemSerialNumberDictionary) 0 == e && (n = o), e++; CustomerServiceClass.InitiateWorkFlowCore(n)} else {var a = []; for (var n in UserSystemSerialNumberDictionary) Array.include(a, {value: n, Title: UserSystemSerialNumberDictionary[n], Description: n}); PopupDialogModelWindow(), PopupDialogModelWindowSetTitle("选择需要售后支持的产品"), PopupDialogModelWindowSetContent("<div id='ChooseSerialNumberDIV' class='Padding10' style='padding-top:0px;'></div>"), ListGroupClass.Display("ChooseSerialNumberDIV", a, function (e) {CustomerServiceClass.InitiateWorkFlowCore(e), ClosePopupDialogModelWindow()})} }, InitiateWorkFlowCore: function (e) {ShowLoadingStatusDIV(null, "正在加载..."), CustomerServiceClass.Abort(), CustomerServiceClass.AjaxLoader = AjaxLoader(!1, "Ajax/CustomerService.aspx?action=InitiateWorkFlow&version=" + Math.random(), "", "", {SerialNumber: e}, function (e) {HideLoadingStatusDIV(), window.open(e.Result)}, function (e) {Common_Error(e), "请先绑定产品序列号" == e.ErrorMsg && CustomerServiceClass.ShowBlindSerialNumberNote()})}, ViewWorkFlow: function (e) {ShowLoadingStatusDIV(null, "正在处理..."), CustomerServiceClass.Abort(), CustomerServiceClass.AjaxLoader = AjaxLoader(!1, "Ajax/CustomerService.aspx?action=ViewWorkFlow&version=" + Math.random(), "", "", {url: e}, function (e) {HideLoadingStatusDIV(), window.open(e.Result)}, Common_Error, {ActionName: "查看流程"})}, CloseRT: function (e) {confirm("请确认是否要关闭此工单？") && (ShowLoadingStatusDIV(null, "正在关闭..."), CustomerServiceClass.Abort(), CustomerServiceClass.AjaxLoader = AjaxLoader(!1, "Ajax/CustomerService.aspx?action=CloseRT&version=" + Math.random(), "", "", {WorkFlowGUID: e}, function (e) {HideLoadingStatusDIV(), HTMLGridClass.LoadData()}, Common_Error, {ActionName: "关闭工单"}))}, ShowBlindSerialNumber: function () {var e = ""; if (0 == Object.Length(UserSystemSerialNumberDictionary)) e = "<div class='Notice Relative' style='margin-top:50px; padding-top:15px; padding-bottom:15px; text-align:center;'><strong>提示：</strong>我们检测到您还没有绑定产品序列号；如您需要售后服务支持，请务必将本账号（" + UserInfo.Username + '）与您的产品序列号绑定。<div style=\'margin-top:5px; text-align:center;\'><a href="BlindSerialNumber.aspx" class="btn btn-warning btn-small btn-round">绑定产品序列号</a></div></div>'; else {for (var n in e += '<div style="position: relative;">', e += '<div class="Title" style="text-align: left; margin-top: 30px; font-size: 20px !important;">我的产品序列号(' + Object.Length(UserSystemSerialNumberDictionary) + ")", e += "</div>", e += '<div class="SerialNumberList">', UserSystemSerialNumberDictionary) e += '<div class="SystemRole">', e += '<div class="Title">', e += "<div>" + UserSystemSerialNumberDictionary[n] + "</div>", e += "</div>", e += '<div class="Description">', e += "<div>" + n + "</div>", e += "</div>", e += '<div class="ControlButton">', e += "<a href=\"javascript:CustomerServiceClass.CancelBlindSerialNumber('" + n + '\')" class="badge badge-danger badge-round">取消绑定</a>', e += "</div>", e += "</div>"; e += '<div class="SystemRole">', e += "<div class='Center'><a href='BlindSerialNumber.aspx' class='wb-plus-circle' style='font-size:28px; margin-top:6px;'></a></div>", e += "<div class='Description' style='text-align:center !important;'>绑定产品序列号</div>", e += "</div>", e += '<div class="ClearFloat"></div>', e += "</div>", e += "</div>"} Element.SetHtml($("#BlindSerialNumberMessageDIV"), e)}, CancelBlindSerialNumber: function (e) {confirm("请确认是否要解除绑定的产品序列号？") && (ShowLoadingStatusDIV(null, "正在处理..."), CustomerServiceClass.Abort(), CustomerServiceClass.AjaxLoader = AjaxLoader(!1, "Ajax/CustomerService.aspx?action=CancelBlindSerialNumber&version=" + Math.random(), "", "", {SerialNumber: e}, function (e) {window.location.reload()}, Common_Error, {ActionName: "解除绑定产品序列号"}))}, AjaxLoader: null, LoadRTList: function () {HTMLGridClass.Config = {PageSize: 10, PageNo: 1, TotalResult: 0, PageListContainerID: "RTPageListContainerDIV"}, HTMLGridClass.Config.FormatDataList = function (e) {var n = ""; n += "<table class='WorkFlowCSSTable FixedTable FullWidth'>", n += "<tr>", n += "<td style='width:70px;' class='Center Bold Font14'>序号</td>", n += "<td style='width:230px;' class='Center Bold Font14'>工单编号</td>", n += "<td style='width:90px;' class='Center Bold Font14'>状态</td>", n += "<td style='width:100px;' class='Center Bold Font14'>问题类型</td>", n += "<td class='Center Bold Font14'>问题描述</td>", n += "<td style='width:150px;' class='Center Bold Font14'>提交日期</td>", n += "<td style='width:70px;' class='Center Bold Font14'>操作</td>", n += "</tr>", e.foreach(function (e, o) {var a = e.问题描述概要.length > 80 ? e.问题描述概要.substring(0, 80) + "..." : e.问题描述概要, l = ""; "流程结束" == e.WorkFlowStep ? l = "<span class='badge badge-dark'>已关闭</span>" : "提交工单" == e.WorkFlowStep ? l = "<span class='badge badge-danger'>待提交</span>" : "客服确认" == e.WorkFlowStep ? l = "<span class='badge badge-danger'>待确认</span>" : "分派" == e.WorkFlowStep ? l = "<span class='badge badge-danger'>待分派</span>" : "处理" == e.WorkFlowStep || "客服验收" == e.WorkFlowStep ? l = "<span class='badge badge-danger'>处理中</span>" : "客户评价" == e.WorkFlowStep && (l = "<span class='badge badge-success'>待评价</span>"), n += "<tr class='" + ("流程结束" == e.WorkFlowStep ? "Completed" : "") + "'>", n += "<td class='Center'>" + ((HTMLGridClass.Config.PageNo - 1) * HTMLGridClass.Config.PageSize + o + 1) + "</td>", n += "<td class='Bold Font13'><a href=\"" + e.url + "\" target='_blank'>" + e.WorkFlowInstanceCode + "</a></td>", n += "<td class='Center'>" + l + "</td>", n += "<td class='Center'>" + e.问题类型 + "</td>", n += "<td>" + a + "</td>", n += "<td class='Center'>" + e.AddDate + "</td>", n += "<td class='Center'>" + ("流程结束" == e.WorkFlowStep ? "" : "<a href=\"javascript:CustomerServiceClass.CloseRT('" + e.WorkFlowGUID + "')\" class='badge badge-danger badge-round'>关闭</a>") + "</td>", n += "</tr>"}), n += "</table>", Element.SetHtml($("#RTDataListContainerDIV"), n), HTMLGridClass.ShowPageList(HTMLGridClass.Config.PageSize, HTMLGridClass.Config.PageNo, HTMLGridClass.Config.TotalResult)}, HTMLGridClass.LoadData = function () {if (null != CustomerServiceClass.AjaxLoader) try {CustomerServiceClass.AjaxLoader.abort()} catch (e) { } var 工单编号 = Element.GetValue($("#工单编号")), 提交时间起 = Element.GetValue($("#提交时间起")), 提交时间止 = Element.GetValue($("#提交时间止")), 工单状态 = Element.GetValue($("#工单状态")), 问题类型 = Element.GetValue($("#问题类型")), SearchKeyword = Element.GetValue($("#SearchKeyword")); Element.SetHtml($("#RTDataListDIV"), GetLoadingMsg("正在加载...")), CustomerServiceClass.AjaxLoader = AjaxLoader(!1, "Ajax/CustomerService.aspx?action=LoadRTList&version=" + Math.random(), "", "", {工单编号: 工单编号, 提交时间起: 提交时间起, 提交时间止: 提交时间止, 工单状态: 工单状态, 问题类型: 问题类型, SearchKeyword: SearchKeyword, PageSize: HTMLGridClass.Config.PageSize, PageNo: HTMLGridClass.Config.PageNo}, function (AjaxResultObject) {var Config = eval("(" + AjaxResultObject.Result + ")"); HTMLGridClass.Config.PageSize = Config.PageSize, HTMLGridClass.Config.PageNo = Config.PageNo, HTMLGridClass.Config.TotalResult = Config.TotalResult, Element.SetHtml($("#RTTotalResultSPAN"), HTMLGridClass.Config.TotalResult), Element.SetHtml($("#RTDataListDIV"), "<div id='RTDataListContainerDIV'></div><div id='RTPageListContainerDIV'></div>"), HTMLGridClass.Config.FormatDataList(eval("(" + Config.DataList + ")"))}, function (e) {Element.SetHtml($("#RTDataListDIV"), "<div class='badge badge-danger'>加载工单列表失败，原因：" + e.ErrorMsg + "</div>")}, {ActionName: "加载工单列表"})}, HTMLGridClass.LoadData()}, ShowAuthorizeApplyList: function () {var e = ""; AuthorizeApplyList.length > 0 && AuthorizeApplyList.foreach(function (n, o) {e += "<div class='Notice Relative' style='margin-top:50px; padding-top:15px; padding-bottom:15px; text-align:center;'><strong>授权申请(" + n.WorkFlowInstanceCode + ")</strong>：您好，为处理工单需要(工单编号：" + n.工单编号 + ")，我们需要获得相应的授权。<div style='margin-top:5px; text-align:center;'><a href=\"" + n.url + '" class="btn btn-warning btn-small btn-round" target="_blank">查看授权申请</a></div></div>'}), Element.SetHtml($("#AuthorizeApplyListDIV"), e)}}; function SystemContactUs(e, n) {void 0 === e && (e = "无"), void 0 === n && (n = "其它"); var o = ""; o += "<div style='padding:10px; padding-bottom:40px;'>", o += "<table class='FullWidth FixedTable'>", o += "<tr>", o += "<td style='width:100px; height:60px; font-weight:bold;'>联系人：<font class='Red'>*</font></td>", o += "<td><input type='text' class='form-control Bold' id='CustomerList_ContactUserName' value='" + ("undefined" == typeof UserInfo ? "" : UserInfo.Realname) + "' style='background-color:#fafafa;' placeholder='您的姓名/公司名称' ></td>", o += "</tr>", o += "<tr>", o += "<td style='height:60px; font-weight:bold;'>联系电话：<font class='Red'>*</font></td>", o += "<td><input type='text' class='form-control Bold' id='CustomerList_PhoneNumber' value='" + ("undefined" == typeof UserInfo ? "" : UserInfo.Username) + "'  style='background-color:#fafafa;' placeholder='您的联系电话' ></td>", o += "</tr>", o += "<tr>", o += "<td style='height:120px; font-weight:bold;'>备注：</td>", o += "<td><textarea type='text' class='form-control' id='CustomerList_Note' value='' style='height:100px; background-color:#fafafa;' placeholder='请告诉我们您的需求，我们会尽快与您联系'></textarea></td>", o += "</tr>", o += "<tr>", o += "<td></td>", o += "<td><div style='margin-top:10px;'><button class='btn btn-primary' onclick=\"SystemContactUsSubmit('" + e + "', '" + n + "')\">提交</button></div></td>", o += "</tr>", o += "</table>", o += "</div>", PopupDialogModelWindow(800), PopupDialogModelWindowSetTitle("<div class='Bold' style='text-align:left; padding-left:10px;'>" + ("预约POC验证" == n ? "申请试运行/搭建DEMO(POC验证)" : "预约演示" == n ? "预约远程/上门演示" : "代理合作" == n ? "代理合作申请" : "联系我们") + "</div>"), PopupDialogModelWindowSetContent(o)} function SystemContactUsSubmit(e, n) {var o = Element.GetValue($("#CustomerList_ContactUserName")), a = Element.GetValue($("#CustomerList_PhoneNumber")), l = Element.GetValue($("#CustomerList_Note")); "" == o ? PopupToastMessage("info", "联系人不能为空") : "" == a ? PopupToastMessage("info", "联系电话不能为空") : IsValidMobilePhone(a) ? (ShowLoadingStatusDIV(null, "正在提交..."), CustomerServiceClass.AjaxLoader = AjaxLoader(!1, "Ajax/SystemContactUs.aspx?version=" + Math.random(), "", "", {TrackID: e, ContactType: n, ContactUserName: o, PhoneNumber: a, Note: l}, function (e) {HideLoadingStatusDIV(), ClosePopupDialogModelWindow(), PopupToastMessage("info", "提交成功，我们会在24小时内和您联系，请注意接听我司电话。")}, Common_Error, {ActionName: "提交"})) : PopupToastMessage("info", "无效的联系电话")} function InitiateToolBarBox() {$('[data-toggle="tooltip"]').tooltip(), BlindEvent($('[data-toggle="tooltip"]'), {click: function (e) {Element.HasClass($(e.currentTarget), "ToolBarItemFocus") ? Element.RemoveClass($(e.currentTarget), "ToolBarItemFocus") : Element.AddClass($(e.currentTarget), "ToolBarItemFocus")}})}